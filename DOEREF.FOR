C234567*****************************************************************
C
C     REFUGEE CRISIS SYSTEM DYNAMICS MODEL
C         DESIGN OF EXPERIMENTS VERSION
C
C     THIS MODEL USES THE TESTED OF THE SYSTEM DYNAMICS MODEL TO PRODUCE 
C     AN OUTPUT FILE 'DOEREF.csv' WHICH CAN BE USED AS INPUT INTO THE R
C     STATISTICAL PACKAGE AND THEREBY PRODUCE THE RESULTS OF A DESIGN OF
C     EXPERIMENTS ON ALL OF THE INPUT PARAMETERS IN THE MODEL
C     

      IMPLICIT DOUBLE PRECISION (A-H, O-Z)

      INCLUDE 'COMVAR.DCL'
      INCLUDE 'DOEVAR.DCL'

      OPEN(1,FILE='R-RUNCONT.DAT')
      OPEN(2,FILE='R-INITIALS.DAT')
      OPEN(3,FILE='R-NORMALS.DAT')
      OPEN(4,FILE='R-CONSTANTS.DAT')
      OPEN(5,FILE='R-EFFECTS.DAT')
      OPEN(6,FILE='R-RESULTS.OUT')
      OPEN(7,FILE='DOEREF.csv')
      OPEN(8,FILE='R-VENSIM.OUT')

      CALL READRUNP
      CALL READINIT
      CALL READNORM
      CALL READCONS
      CALL READETAB

C***********************************************************************
C
C     WRITE HEADING

      WRITE(7,1000) (I, I = 1,9),(J, J = 10,98)
1000  FORMAT(' CAD,',9('N0',I1','),88('N',I2,','),'N',I2)

      CALL SRAND(ISEED)

      DO 10 M = 1,NINTER

         CALL RANDPAR

         CALL RUNSIM(CAD)

         WRITE(7,1010) CAD,(N(I), I = 1,98)
1010     FORMAT(F15.3,',',97(I5,','),I5)

10    CONTINUE

      STOP
      END

      SUBROUTINE READRUNP

      IMPLICIT DOUBLE PRECISION (A-H, O-Z)

      INCLUDE 'COMVAR.DCL'
      INCLUDE 'DOEVAR.DCL'

C***********************************************************************
C     RUN PARAMETERS
C     XINC = STEP SIZE OF SIMULATION
C     ENDTIME = LENGTH OF SIMULATION
C     ISEED = RANDOM NUMBER GENERATOR SEED
C     NINTER = NUMBER OF RANDOM SIMULATION RUNS

      READ(1,*)
      READ(1,*)
      READ(1,*)
      READ(1,*) XINC,ENDTIME,ISEED,NINTER

      RETURN
      END

C***********************************************************************
C
      SUBROUTINE READINIT

      IMPLICIT DOUBLE PRECISION (A-H, O-Z)

      INCLUDE 'COMVAR.DCL'
      INCLUDE 'DOEVAR.DCL'


C***********************************************************************
C     MIDDLE INITIAL VALUES
C
C01   XBCNRM = INITIAL BORDER CONTROL RESOURCES (BOATS)
C02   XBCRRM = INITIAL BORDER CROSSING RESOURCES (BOATS)
C03   XBM = INITIAL BUSINESSES (BUSINESSES)
C04   XDFDM = INITIAL DEATHS FROM DISEASE (FAMILIES)
C05   XDFSM = INITIAL DEATHS FROM STARVATION (FAMILIES)
C06   XDFUM = INITIAL DEATHS FROM UNSUCCESSFUL BORDER CROSSINGS (FAMILIES)
C07   XDFVM = INITIAL DEATHS FROM VIOLENCE (FAMILIES)
C08   XDEM = INITIAL DIPLOMATIC EFFORT (DIPLOMATS)
C09   XFM = INITIAL FOOD (FOOD UNITS)
C10   XIOM = INITIAL IMMIGRATION OFFICERS (OFFICERS)
C11   XMPM = INITIAL MEDICAL PRACTITIONERS (DOCTORS)
C12   XPM = INITIAL PEACEKEEPERS (SOLDIERS)
C13   XPFCM = INITIAL POPULATION IN FOREIGN COUNTRY (FAMILIES)
C14   XPWDM = INITIAL POPULATION WITH DISEASE (FAMILIES)
C15   XRM = INITIAL REFUGEES (FAMILIES)
C16   XRIM = INITIAL REFUGEES WHO HAVE IMMIGRATED (FAMILIES)
C17   XSHM = INITIAL SAFE HAVENS (HAVENS)
C18   XSBCM = INITIAL SUCCESSFUL BORDER CROSSINGS (BORDER CROSSINGS)
C19   XUBCM = INITIAL UNSUCCESSFUL BORDER CROSSINGS (BORDER CROSSINGS)
C20   XVM = INITIAL VIOLENCE (BATTLES)

      READ(2,*)

C
C01   XBCNRM = INITIAL BORDER CONTROL RESOURCES (BOATS)
      READ(2,*)
      READ(2,*)
      READ(2,*) XBCNRM
C
C02   XBCRRM = INITIAL BORDER CROSSING RESOURCES (BOATS)
      READ(2,*)
      READ(2,*)
      READ(2,*) XBCRRM
C
C03   XBM = INITIAL BUSINESSES (BUSINESSES)
      READ(2,*)
      READ(2,*)
      READ(2,*) XBM
C
C04   XDFDM = INITIAL DEATHS FROM DISEASE (FAMILIES)
      READ(2,*)
      READ(2,*)
      READ(2,*) XDFDM
C
C05   XDFSM = INITIAL DEATHS FROM STARVATION (FAMILIES)
      READ(2,*)
      READ(2,*)
      READ(2,*) XDFSM
C
C06   XDFUM = INITIAL DEATHS FROM UNSUCCESSFUL BORDER CROSSINGS (FAMILIES)
      READ(2,*)
      READ(2,*)
      READ(2,*) XDFUM
C
C07   XDFVM = INITIAL DEATHS FROM VIOLENCE (FAMILIES)
      READ(2,*)
      READ(2,*)
      READ(2,*) XDFVM
C
C08   XDEM = INITIAL DIPLOMATIC EFFORT (DIPLOMATS)
      READ(2,*)
      READ(2,*)
      READ(2,*) XDEM
C
C09   XFM = INITIAL FOOD (FOOD UNITS)
      READ(2,*)
      READ(2,*)
      READ(2,*) XFM
C
C10   XIOM = INITIAL IMMIGRATION OFFICERS (OFFICERS)
      READ(2,*)
      READ(2,*)
      READ(2,*) XIOM
C
C11   XMPM = INITIAL MEDICAL PRACTITIONERS (DOCTORS)
      READ(2,*)
      READ(2,*)
      READ(2,*) XMPM
C
C12   XPM = INITIAL PEACEKEEPERS (SOLDIERS)
      READ(2,*)
      READ(2,*)
      READ(2,*) XPM
C
C13   XPFCM = INITIAL POPULATION IN FOREIGN COUNTRY (FAMILIES)
      READ(2,*)
      READ(2,*)
      READ(2,*) XPFCM
C
C14   XPWDM = INITIAL POPULATION WITH DISEASE (FAMILIES)
      READ(2,*)
      READ(2,*)
      READ(2,*) XPWDM
C
C15   XRM = INITIAL REFUGEES (FAMILIES)
      READ(2,*)
      READ(2,*)
      READ(2,*) XRM
C
C16   XRIM = INITIAL REFUGEES WHO HAVE IMMIGRATED (FAMILIES)
      READ(2,*)
      READ(2,*)
      READ(2,*) XRIM
C
C17   XSHM = INITIAL SAFE HAVENS (HAVENS)
      READ(2,*)
      READ(2,*)
      READ(2,*) XSHM
C
C18   XSBCM = INITIAL SUCCESSFUL BORDER CROSSINGS (BORDER CROSSINGS)
      READ(2,*)
      READ(2,*)
      READ(2,*) XSBCM
C
C19   XUBCM = INITIAL UNSUCCESSFUL BORDER CROSSINGS (BORDER CROSSINGS)
      READ(2,*)
      READ(2,*)
      READ(2,*) XUBCM
C
C20   XVM = INITIAL VIOLENCE (BATTLES)
      READ(2,*)
      READ(2,*)
      READ(2,*) XVM

      RETURN
      END

C***********************************************************************
C
      SUBROUTINE READNORM

      IMPLICIT DOUBLE PRECISION (A-H, O-Z)

      INCLUDE 'COMVAR.DCL'
      INCLUDE 'DOEVAR.DCL'


C***********************************************************************
C     MIDDLE NORMAL VALUES
C01     YABCM   = NORMAL ATTEMPTED BORDER CROSSINGS PER MONTH 
C              (BORDER CROSSINGS/MONTH)
C02     YBRM    = NORMAL BIRTH RATE 
C              (FAMILIES/FAMILIES/MONTH)
C03     YBCNRM  = NORMAL BORDER CONTROL RESOURCES 
C              (BOATS)
C04     YBCRRM  = NORMAL BORDER CROSSING RESOURCES 
C              (BOATS)
C05     YDRFDM  = NORMAL DEATH RATE FROM DISEASE 
C              (FAMILIES/FAMILIES/MONTH)
C06     YDRFSM  = NORMAL DEATH RATE FROM STARVATION 
C              (FAMILIES/FAMILIES/MONTH)
C07     YDRFVM  = NORMAL DEATH RATE FROM VIOLENCE 
C              (FAMILIES/FAMILIES/MONTH)
C08     YDMM    = NORMAL DEATHS PER MONTH 
C              (FAMILIES/MONTH)
C09     YDUBCM  = NORMAL DEATHS PER MONTH FROM UNSUCCESSFUL BORDER 
C              CROSSINGS (FAMILIES/MONTH)
C10     YPSHM   = NORMAL FAMILIES IN SAFE HAVENS
C              (FAMILIES)
C11     YFBCM   = NORMAL FAMILIES PER BORDER CROSSING 
C              (FAMILIES)
C12     YFM     = NORMAL FOOD 
C              (FOOD UNITS)
C13     YFGRM   = NORMAL FOOD GROWTH RATE 
C              (FOOD UNITS/FOOD UNIT/MONTH)
C14     YFUBCM  = NORMAL FRACTION OF UNSUCCESSFUL BORDER CROSSINGS 
C              (DMNL)
C15     YIRM    = NORMAL INFECTION RATE 
C              (FAMILIES/FAMILIES/MONTH)
C16     YPRSHM  = NORMAL PEACEKEEPERS REQUIRED TO PROTECT SAFE HAVEN
C              (SOLDIERS)
C17     YRM     = NORMAL REFUGEES
C              (FAMILIES)
C18     YSBCM   = NORMAL SUCCESSFUL BORDER CROSSINGS PER MONTH
C              (BORDER CROSSINGS/MONTH)
C19     YTCSHM  = NORMAL TIME TO CREATE A SAFE HAVEN
C              (MONTHS)
C20     YTDLFCM = NORMAL TIME TO DECIDE TO LEAVE FOREIGN COUNTRY
C              (MONTHS)
C21     YTDSHM  = NORMAL TIME TO DESTROY A SAFE HAVEN
C              (MONTHS)
C22     YTDBM   = NORMAL TIME TO DESTROY A BUSINESS
C              (MONTHS)
C23     YTIM    = NORMAL TOTAL INVESTMENT
C              (MILLION DOLLARS/MONTH)
C24     YUBCM   = NORMAL UNSUCCESSFUL BORDER CROSSINGS PER MONTH
C              (BORDER CROSSINGS/MONTH)
C25     YVRDBM  = NORMAL VIOLENCE REQUIRED TO DESTROY A BUSINESS
C              (BATTLES)
C26     YVRDSHM = NORMAL VIOLENCE REQUIRED TO DESTROY A SAFE HAVEN
C              (BATTLES)
C27     YVRDHM  = NORMAL VIOLENCE REQUIRED TO DESTROY HARVEST
C              (BATTLES)
C28     YVRDFAM = NORMAL VIOLENCE REQUIRED TO DISRUPT DELIVERY OF FOOD
C              AID (BATTLES)

      READ(3,*)

C
C01     YABCM = NORMAL ATTEMPTED BORDER CROSSINGS PER MONTH 
C               (BORDER CROSSINGS/MONTH)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YABCM
C
C02     YBRM = NORMAL BIRTH RATE 
C             (FAMILIES/FAMILIES/MONTH)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YBRM
C
C03     YBCNRM = NORMAL BORDER CONTROL RESOURCES 
C               (BOATS)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YBCNRM
C
C04     YBCRRM = NORMAL BORDER CROSSING RESOURCES 
C               (BOATS)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YBCRRM
C
C05     YDRFDM = NORMAL DEATH RATE FROM DISEASE 
C               (FAMILIES/FAMILIES/MONTH)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YDRFDM
C
C06     YDRFSM = NORMAL DEATH RATE FROM STARVATION 
C               (FAMILIES/FAMILIES/MONTH)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YDRFSM
C
C07     YDRFVM = NORMAL DEATH RATE FROM VIOLENCE 
C               (FAMILIES/FAMILIES/MONTH)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YDRFVM
C
C08     YDMM = NORMAL DEATHS PER MONTH 
C             (FAMILIES/MONTH)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YDMM
C
C09     YDUBCM = NORMAL DEATHS PER MONTH FROM UNSUCCESSFUL BORDER 
C               CROSSINGS (FAMILIES/MONTH)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YDUBCM
C
C10     YPSHM = NORMAL FAMILIES IN SAFE HAVENS
C              (FAMILIES)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YPSHM
C
C11     YFBCM = NORMAL FAMILIES PER BORDER CROSSING 
C              (FAMILIES)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YFBCM
C
C12     YFM = NORMAL FOOD 
C            (FOOD UNITS)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YFM
C
C13     YFGRM = NORMAL FOOD GROWTH RATE 
C              (FOOD UNITS/FOOD UNIT/MONTH)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YFGRM
C
C14     YFUBCM = NORMAL FRACTION OF UNSUCCESSFUL BORDER CROSSINGS 
C               (DMNL)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YFUBCM
C
C15     YIRM = NORMAL INFECTION RATE 
C             (FAMILIES/FAMILIES/MONTH)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YIRM
C
C16     YPRSHM = NORMAL PEACEKEEPERS REQUIRED TO PROTECT SAFE HAVEN
C               (SOLDIERS)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YPRSHM
C
C17     YRM = NORMAL REFUGEES
C            (FAMILIES)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YRM
C
C18     YSBCM = NORMAL SUCCESSFUL BORDER CROSSINGS PER MONTH
C              (BORDER CROSSINGS/MONTH)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YSBCM
C
C19     YTCSHM = NORMAL TIME TO CREATE A SAFE HAVEN
C               (MONTHS)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YTCSHM
C
C20     YTDLFCM = NORMAL TIME TO DECIDE TO LEAVE FOREIGN COUNTRY
C                (MONTHS)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YTDLFCM
C
C21     YTDSHM = NORMAL TIME TO DESTROY A SAFE HAVEN
C               (MONTHS)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YTDSHM
C
C22     YTDBM = NORMAL TIME TO DESTROY A BUSINESS
C              (MONTHS)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YTDBM
C
C23     YTIM = NORMAL TOTAL INVESTMENT
C             (MILLION DOLLARS/MONTH)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YTIM
C
C24     YUBCM = NORMAL UNSUCCESSFUL BORDER CROSSINGS PER MONTH
C              (BORDER CROSSINGS/MONTH)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YUBCM
C
C25     YVRDBM = NORMAL VIOLENCE REQUIRED TO DESTROY A BUSINESS
C               (BATTLES)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YVRDBM
C
C26     YVRDSHM = NORMAL VIOLENCE REQUIRED TO DESTROY A SAFE HAVEN
C            	 (BATTLES)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YVRDSHM
C
C27     YVRDHM = NORMAL VIOLENCE REQUIRED TO DESTROY HARVEST
C               (BATTLES)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YVRDHM
C
C28     YVRDFAM = NORMAL VIOLENCE REQUIRED TO DISRUPT DELIVERY OF FOOD
C               AID (BATTLES)
      READ(3,*)
      READ(3,*)
      READ(3,*)
      READ(3,*) YVRDFAM

      RETURN
      END

 
C***********************************************************************
C
      SUBROUTINE READCONS

      IMPLICIT DOUBLE PRECISION (A-H, O-Z)

      INCLUDE 'COMVAR.DCL'
      INCLUDE 'DOEVAR.DCL'


C***********************************************************************
C     MIDDLE VALUES FOR THE CONSTANTS
C
C01   ACPFM   = AVERAGE CONSUMPTION PER FAMILY
C            (FOOD UNITS/FAMILIES/MONTH)
C02   ACBCRM  = AVERAGE COST OF BORDER CONTROL RESOURCES
C            (MILLION DOLLARS/BOATS/MONTH)
C03   ACDEM   = AVERAGE COST OF DIPLOMATIC EFFORT
C            (MILLION DOLLARS/DIPLOMATS/MONTH)
C04   ACFUM   = AVERAGE COST OF A FOOD UNIT
C            (MILLION DOLLARS/FOOD UNIT)
C05   ACIOM   = AVERAGE COST OF IMMIGRATION OFFICERS
C            (MILLION DOLLARS/OFFICERS/MONTH)
C06   ACMPM   = AVERAGE COST OF MEDICAL PRACTITIONERS
C            (MILLION DOLLARS/DOCTORS/MONTH)
C07   ACPM    = AVERAGE COST OF PEACEKEEPERS
C           (MILLION DOLLARS/SOLDIER/MONTH)
C08   ACSBM   = AVERAGE COST TO SETUP A BUSINESS
C            (MILLION DOLLARS/BUSINESSES)
C09   ADCCFM  = AVERAGE DIPLOMATS TO CREATE A CEASE FIRE
C            (DIPLOMATS/BATTLES)
C10   AJBM    = AVERAGE JOBS PER BUSINESS
C           (FAMILIES/BUSINESSES)
C11   ALEM    = AVERAGE LIFE EXPECTENCY
C            (MONTHS)
C12   APRBM   = AVERAGE PEACEKEEPERS TO REDUCE A BATTLE
C            (SOLDIERS/BATTLES)
C13   APMPM   = AVERAGE PEOPLE A MEDICAL PRACTITIONER CAN HANDLE
C            (FAMILIES/DOCTORS)
C14   APSHM   = AVERAGE POPULATION PER SAFE HAVEN
C            (FAMILIES/HAVENS)
C15   ATABCRM = AVERAGE TIME TO ADD BORDER CROSSING RESOURCES
C            (MONTHS)
C16   ATCVLM  = AVERAGE TIME TO CHANGE VIOLENCE LEVEL
C            (MONTHS)
C17   ATCDM   = AVERAGE TIME TO CURE DISEASE
C            (MONTHS)
C18   ATDBCRM = AVERAGE TIME TO DEPLOY BORDER CONTROL RESOURCES
C            (MONTHS)
C19   ATDPM   = AVERAGE TIME TO DEPLOY PEACEKEEPERS
C            (MONTHS)
C20   ATEDM   = AVERAGE TIME TO EMPLOY DIPLOMATS
C            (MONTHS)
C21   ATHMPM  = AVERAGE TIME TO HIRE MEDICAL PRACTITIONER
C            (MONTHS)
C22   ATPIPM  = AVERAGE TIME TO PROCESS IMMIGRATION PAPERS
C            (MONTHS)
C23   ATTIOM  = AVERAGE TIME TO TRAIN IMMIGRATION OFFICERS
C            (MONTHS)
C24   BMBCM   = BOAT MONTHS PER BORDER CROSSING
C            (BOATS*MONTHS)/BORDER CROSSING
C25   FPIOM   = FAMILIES PROCESSED AT SAME TIME BY IMMIGRATION OFFICER
C            (FAMILIES/IMMIGRATION OFFICERS)
C26   FDUBCM  = FRACTION OF DEATHS PER UNSUCCESSFUL BORDER CROSSING
C            (DMNL)
C27   VERM    = VIOLENCE ESCALATION RATE
C            (DMNL)

      READ(4,*)
C
C01   ACPFM = AVERAGE CONSUMPTION PER FAMILY
C            (FOOD UNITS/FAMILIES/MONTH)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) ACPFM
C
C02   ACBCRM = AVERAGE COST OF BORDER CONTROL RESOURCES
C             (MILLION DOLLARS/BOATS/MONTH)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) ACBCRM
C
C03   ACDEM = AVERAGE COST OF DIPLOMATIC EFFORT
C            (MILLION DOLLARS/DIPLOMATS/MONTH)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) ACDEM
C
C04   ACFUM = AVERAGE COST OF A FOOD UNIT
C            (MILLION DOLLARS/FOOD UNIT)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) ACFUM
C
C05   ACIOM = AVERAGE COST OF IMMIGRATION OFFICERS
C            (MILLION DOLLARS/OFFICERS/MONTH)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) ACIOM
C
C06   ACMPM = AVERAGE COST OF MEDICAL PRACTITIONERS
C            (MILLION DOLLARS/DOCTORS/MONTH)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) ACMPM
C
C07   ACPM = AVERAGE COST OF PEACEKEEPERS
C           (MILLION DOLLARS/SOLDIER/MONTH)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) ACPM
C
C08   ACSBM = AVERAGE COST TO SETUP A BUSINESS
C            (MILLION DOLLARS/BUSINESSES)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) ACSBM
C
C09   ADCCFM = AVERAGE DIPLOMATS TO CREATE A CEASE FIRE
C             (DIPLOMATS/BATTLES)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) ADCCFM
C
C10   AJBM = AVERAGE JOBS PER BUSINESS
C           (FAMILIES/BUSINESSES)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) AJBM
C
C11   ALEM = AVERAGE LIFE EXPECTENCY
C           (MONTHS)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) ALEM
C
C12   APRBM = AVERAGE PEACEKEEPERS TO REDUCE A BATTLE
C            (SOLDIERS/BATTLES)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) APRBM
C
C13   APMPM = AVERAGE PEOPLE A MEDICAL PRACTITIONER CAN HANDLE
C            (FAMILIES/DOCTORS)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) APMPM
C
C14   APSHM = AVERAGE POPULATION PER SAFE HAVEN
C            (FAMILIES/HAVENS)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) APSHM
C
C15   ATABCRM = AVERAGE TIME TO ADD BORDER CROSSING RESOURCES
C              (MONTHS)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) ATABCRM
C
C16   ATCVLM = AVERAGE TIME TO CHANGE VIOLENCE LEVEL
C             (MONTHS)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) ATCVLM
C
C17   ATCDM = AVERAGE TIME TO CURE DISEASE
C            (MONTHS)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) ATCDM
C
C18   ATDBCRM = AVERAGE TIME TO DEPLOY BORDER CONTROL RESOURCES
C              (MONTHS)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) ATDBCRM
C
C19   ATDPM = AVERAGE TIME TO DEPLOY PEACEKEEPERS
C            (MONTHS)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) ATDPM
C
C20   ATEDM = AVERAGE TIME TO EMPLOY DIPLOMATS
C            (MONTHS)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) ATEDM
C
C21   ATHMPM = AVERAGE TIME TO HIRE MEDICAL PRACTITIONER
C             (MONTHS)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) ATHMPM
C
C22   ATPIPM = AVERAGE TIME TO PROCESS IMMIGRATION PAPERS
C             (MONTHS)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) ATPIPM
C
C23   ATTIOM = AVERAGE TIME TO TRAIN IMMIGRATION OFFICERS
C             (MONTHS)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) ATTIOM
C
C24   BMBCM = BOAT MONTHS PER BORDER CROSSING
C            (BOATS*MONTHS)/BORDER CROSSING
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) BMBCM
C
C25   FPIOM = FAMILIES PROCESSED AT SAME TIME BY IMMIGRATION OFFICER
C            (FAMILIES/IMMIGRATION OFFICERS)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) FPIOM
C
C26   FDUBCM = FRACTION OF DEATHS PER UNSUCCESSFUL BORDER CROSSING
C             (DMNL)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) FDUBCM
C
C27   VERM = VIOLENCE ESCALATION RATE
C           (DMNL)
      READ(4,*)
      READ(4,*)
      READ(4,*)
      READ(4,*) VERM

      RETURN
      END
     
C***********************************************************************
C
      SUBROUTINE READETAB

      IMPLICIT DOUBLE PRECISION (A-H, O-Z)

      INCLUDE 'COMVAR.DCL'
      INCLUDE 'DOEVAR.DCL'

   
C***********************************************************************      
C     TABLE FUNCTIONS
C
C01     EBCRABT = EFFECT OF BORDER CONTRL ON ATTEMPTED BORDER CROSSINGS
C               PER MONTH
C02     EBCRACT = EFFECT OF BORDER CROSSING RESOURCES ON ATTEMPTED BORDER
C               CROSSINGS PER MONTH TABLE
C03     EBCRFCT = EFFECT OF BORDER CROSSING RESOURCES ON FAMILIES PER
C               BORDER CROSSING TABLE
C04     EBCRUCT = EFFECT OF BORDER CROSSING RESOURCES ON FRACTION OF 
C               UNSUCCESSFUL BORDER CROSSINGS TABLE
C05	EOCODRT = EFFECT OF CROWDING ON DISEASE RATE 
C               TABLE
C06     EDFIBCT = EFFECT OF DEATHS PER MONTH ON FRACTION OF INVESTMENT IN
C               BORDER CONTROL TABLE
C07     EDPMTIT = EFFECT OF DEATHS PER MONTH ON TOTAL INVESTMENT 
C               TABLE
C08     EDFIHST = EFFECT OF DISEASE ON FRACTION OF INVESTMENT ON HEALTH
C               SERVICES TABLE
C09     EFFIFAT = EFFECT OF FAMINE ON FRACTION OF INVESTMENT IN FOOD AID
C               TABLE
C10     EPTCSHT = EFFECT OF PEACEKEEPERS ON TIME TO CREATE SAFE HAVEN
C               TABLE
C11     ERTDLCT = EFFECT OF PEOPLE AT RISK ON AVERAGE TIME TO DECIDE TO 
C               LEAVE FOREIGN COUNTRY TABLE
C12     EPDOTIT = EFFECT OF PEOPLE IN DANGER ON TOTAL INVESTMENT 
C               TABLE
C13     ERABCMT = EFFECT OF REFUGEES ON ATTEMPTED BORDER CROSSINGS PER 
C               MONTH TABLE
C14     ERDBCRT = EFFECT OF REFUGEES ON DESIRED BORDER CROSSING RESOURCES 
C               TABLE
C15     ERFIIIT = EFFECT OF REFUGEES ON FRACTION OF INVESTMENT IN 
C               IMMIGRATION TABLE
C16     ESBCBCT = EFFECT OF SUCCESSFUL BORDER CROSSINGS ON ATTEMPTED 
C               BORDER CROSSINGS PER MONTH TABLE
C17     EUBCBCT = EFFECT OF UNSUCCESSFUL BORDER CROSSINGS ON ATTEMPTED 
C               BORDER CROSSING PER MONTH TABLE
C18     EVODFAT = EFFECT OF VIOLENCE ON DISTRIBUTION OF FOOD AID
C               TABLE
C19     EVIOFMT = EFFECT OF VIOLENCE ON FAMINE 
C               TABLE
C20     EVFIDPT = EFFECT OF VIOLENCE ON FRACTION OF INVESTMENT ON 
C               DIPLOMACY TABLE
C21     EVFIPKT = EFFECT OF VIOLENCE ON FRACTION OF INVESTMENT IN 
C               PEACEKEEPING TABLE
C22     EVITDBT = EFFECT OF VIOLENCE ON TIME TO DESTROY A BUSINESS
C               TABLE
C23     EVTDSHT = EFFECT OF VIOLENCE ON TIME TO DESTROY A SAFE HAVEN
C               TABLE	

      READ(5,*)
 
      READ(5,*)
      READ(5,*)
      READ(5,*)
C
C01     EBCRABT = EFFECT OF BORDER CONTRL ON ATTEMPTED BORDER CROSSINGS
C               PER MONTH
      DO 110 I = 1,3
         READ(5,*) (EBCRABT(I,J), J = 1,2)
  110 CONTINUE
      READ(5,*)
      READ(5,*)
      READ(5,*)
C     
C02     EBCRACT = EFFECT OF BORDER CROSSING RESOURCES ON ATTEMPTED BORDER
C               CROSSINGS PER MONTH TABLE
      DO 120 I = 1,3
         READ(5,*) (EBCRACT(I,J), J = 1,2)
  120 CONTINUE
      READ(5,*)
      READ(5,*)
      READ(5,*)
C
C03     EBCRFCT = EFFECT OF BORDER CROSSING RESOURCES ON FAMILIES PER
C               BORDER CROSSING TABLE
      DO 130 I = 1,3
         READ(5,*) (EBCRFCT(I,J), J = 1,2)
  130 CONTINUE
      READ(5,*)
      READ(5,*)
      READ(5,*)
C
C04     EBCRUCT = EFFECT OF BORDER CROSSING RESOURCES ON FRACTION OF 
C               UNSUCCESSFUL BORDER CROSSINGS TABLE
      DO 140 I = 1,3
         READ(5,*) (EBCRUCT(I,J), J = 1,2)
  140 CONTINUE
      READ(5,*)
      READ(5,*)
      READ(5,*)
C
C05	EOCODRT = EFFECT OF CROWDING ON DISEASE RATE 
C               TABLE
      DO 150 I = 1,3
         READ(5,*) (EOCODRT(I,J), J = 1,2)
  150 CONTINUE
      READ(5,*)
      READ(5,*)
      READ(5,*)
C
C06     EDFIBCT = EFFECT OF DEATHS PER MONTH ON FRACTION OF INVESTMENT IN
C               BORDER CONTROL TABLE
      DO 160 I = 1,3
         READ(5,*) (EDFIBCT(I,J), J = 1,2)
  160 CONTINUE
      READ(5,*)
      READ(5,*)
      READ(5,*)
C
C07     EDPMTIT = EFFECT OF DEATHS PER MONTH ON TOTAL INVESTMENT 
C               TABLE
      DO 170 I = 1,3
         READ(5,*) (EDPMTIT(I,J), J = 1,2)
  170 CONTINUE
      READ(5,*)
      READ(5,*)
      READ(5,*)
C
C08     EDFIHST = EFFECT OF DISEASE ON FRACTION OF INVESTMENT ON HEALTH
C               SERVICES TABLE
      DO 180 I = 1,3
         READ(5,*) (EDFIHST(I,J), J = 1,2)
  180 CONTINUE
      READ(5,*)
      READ(5,*)
      READ(5,*)
C
C09     EFFIFAT = EFFECT OF FAMINE ON FRACTION OF INVESTMENT IN FOOD AID
C               TABLE
      DO 190 I = 1,3
         READ(5,*) (EFFIFAT(I,J), J =1,2)
  190 CONTINUE
      READ(5,*)
      READ(5,*)
      READ(5,*)
C
C10     EPTCSHT = EFFECT OF PEACEKEEPERS ON TIME TO CREATE SAFE HAVEN
C               TABLE
      DO 200 I = 1,3
         READ(5,*) (EPTCSHT(I,J), J =1,2)
  200 CONTINUE
      READ(5,*)
      READ(5,*)
      READ(5,*)
C
C11     ERTDLCT = EFFECT OF PEOPLE AT RISK ON AVERAGE TIME TO DECIDE TO 
C               LEAVE FOREIGN COUNTRY TABLE
      DO 210 I = 1,3
         READ(5,*) (ERTDLCT(I,J), J =1,2)
  210 CONTINUE
      READ(5,*)
      READ(5,*)
      READ(5,*)
C
C12     EPDOTIT = EFFECT OF PEOPLE IN DANGER ON TOTAL INVESTMENT 
C               TABLE
      DO 220 I = 1,3
         READ(5,*) (EPDOTIT(I,J), J =1,2)
  220 CONTINUE
      READ(5,*)
      READ(5,*)
      READ(5,*)
C
C13     ERABCMT = EFFECT OF REFUGEES ON ATTEMPTED BORDER CROSSINGS PER 
C               MONTH TABLE
      DO 230 I = 1,3
        READ(5,*) (ERABCMT(I,J), J = 1,2)
  230 CONTINUE
      READ(5,*)
      READ(5,*)
      READ(5,*)
C
C14     ERDBCRT = EFFECT OF REFUGEES ON DESIRED BORDER CROSSING RESOURCES 
C               TABLE
      DO 240 I = 1,3
         READ(5,*) (ERDBCRT(I,J), J = 1,2)
  240 CONTINUE
      READ(5,*)
      READ(5,*)
      READ(5,*)
C
C15     ERFIIIT = EFFECT OF REFUGEES ON FRACTION OF INVESTMENT IN 
C               IMMIGRATION TABLE
      DO 250 I = 1,3
         READ(5,*) (ERFIIIT(I,J), J = 1,2)
  250 CONTINUE
      READ(5,*)
      READ(5,*)
      READ(5,*)
C
C16     ESBCBCT = EFFECT OF SUCCESSFUL BORDER CROSSINGS ON ATTEMPTED 
C               BORDER CROSSINGS PER MONTH TABLE
      DO 260 I = 1,3
         READ(5,*) (ESBCBCT(I,J), J = 1,2)
  260 CONTINUE
      READ(5,*)
      READ(5,*)
      READ(5,*)
C
C17     EUBCBCT = EFFECT OF UNSUCCESSFUL BORDER CROSSINGS ON ATTEMPTED 
C               BORDER CROSSING PER MONTH TABLE
      DO 270 I = 1,3
         READ(5,*) (EUBCBCT(I,J), J = 1,2)
  270 CONTINUE
      READ(5,*)
      READ(5,*)
      READ(5,*)
C
C18     EVODFAT = EFFECT OF VIOLENCE ON DISTRIBUTION OF FOOD AID
C               TABLE
      DO 280 I = 1,3
         READ(5,*) (EVODFAT(I,J), J = 1,2)
  280 CONTINUE
      READ(5,*)
      READ(5,*)
      READ(5,*)
C
C19     EVIOFMT = EFFECT OF VIOLENCE ON FAMINE 
C               TABLE
      DO 290 I = 1,3
         READ(5,*) (EVIOFMT(I,J), J = 1,2)
  290 CONTINUE
      READ(5,*)
      READ(5,*)
      READ(5,*)
C
C20     EVFIDPT = EFFECT OF VIOLENCE ON FRACTION OF INVESTMENT ON 
C               DIPLOMACY TABLE
      DO 300 I = 1,3
         READ(5,*) (EVFIDPT(I,J), J = 1,2)
  300 CONTINUE
      READ(5,*)
      READ(5,*)
      READ(5,*)
C
C21     EVFIPKT = EFFECT OF VIOLENCE ON FRACTION OF INVESTMENT IN 
C               PEACEKEEPING TABLE
      DO 310 I = 1,3
         READ(5,*) (EVFIPKT(I,J), J = 1,2)
  310 CONTINUE
      READ(5,*)
      READ(5,*)
      READ(5,*)
C
C22     EVITDBT = EFFECT OF VIOLENCE ON TIME TO DESTROY A BUSINESS
C               TABLE
      DO 320 I = 1,3
         READ(5,*) (EVITDBT(I,J), J = 1,2)
  320 CONTINUE
      READ(5,*)
      READ(5,*)
      READ(5,*)
C
C23     EVTDSHT = EFFECT OF VIOLENCE ON TIME TO DESTROY A SAFE HAVEN
C               TABLE	
      DO 330 I = 1,3
         READ(5,*) (EVTDSHT(I,J), J = 1,2)
  330 CONTINUE

      EBCRABM = EBCRABT(2,1)
      EBCRACM = EBCRACT(2,1)
      EBCRFCM = EBCRFCT(2,1)
      EBCRUCM = EBCRUCT(2,1)
      EOCODRM = EOCODRT(2,1)
      EDFIBCM = EDFIBCT(2,1)
      EDPMTIM = EDPMTIT(2,1)
      EDFIHSM = EDFIHST(2,1)
      EFFIFAM = EFFIFAT(2,1)
      EPTCSHM = EPTCSHT(2,1)
      ERTDLCM = ERTDLCT(2,1)
      EPDOTIM = EPDOTIT(2,1)
      ERABCMM = ERABCMT(2,1)
      ERDBCRM = ERDBCRT(2,1)
      ERFIIIM = ERFIIIT(2,1)
      ESBCBCM = ESBCBCT(2,1)
      EUBCBCM = EUBCBCT(2,1)
      EVODFAM = EVODFAT(2,1)
      EVIOFMM = EVIOFMT(2,1)
      EVFIDPM = EVFIDPT(2,1)
      EVFIPKM = EVFIPKT(2,1)
      EVITDBM = EVITDBT(2,1)
      EVTDSHM = EVTDSHT(2,1)

      RETURN
      END 

C***********************************************************************
C
      SUBROUTINE RANDPAR

      IMPLICIT DOUBLE PRECISION (A-H, O-Z)

      INCLUDE 'COMVAR.DCL'
      INCLUDE 'DOEVAR.DCL'


C     SET PARAMETERS RANDOMLY FOR EACH SIMULATION RUN
C
C***********************************************************************
C     MIDDLE INITIAL VALUES
C
C01   XBCNRM = INITIAL BORDER CONTROL RESOURCES (BOATS)
C02   XBCRRM = INITIAL BORDER CROSSING RESOURCES (BOATS)
C03   XBM = INITIAL BUSINESSES (BUSINESSES)
C04   XDFDM = INITIAL DEATHS FROM DISEASE (FAMILIES)
C05   XDFSM = INITIAL DEATHS FROM STARVATION (FAMILIES)
C06   XDFUM = INITIAL DEATHS FROM UNSUCCESSFUL BORDER CROSSINGS (FAMILIES)
C07   XDFVM = INITIAL DEATHS FROM VIOLENCE (FAMILIES)
C08   XDEM = INITIAL DIPLOMATIC EFFORT (DIPLOMATS)
C09   XFM = INITIAL FOOD (FOOD UNITS)
C10   XIOM = INITIAL IMMIGRATION OFFICERS (OFFICERS)
C11   XMPM = INITIAL MEDICAL PRACTITIONERS (DOCTORS)
C12   XPM = INITIAL PEACEKEEPERS (SOLDIERS)
C13   XPFCM = INITIAL POPULATION IN FOREIGN COUNTRY (FAMILIES)
C14   XPWDM = INITIAL POPULATION WITH DISEASE (FAMILIES)
C15   XRM = INITIAL REFUGEES (FAMILIES)
C16   XRIM = INITIAL REFUGEES WHO HAVE IMMIGRATED (FAMILIES)
C17   XSHM = INITIAL SAFE HAVENS (HAVENS)
C18   XSBCM = INITIAL SUCCESSFUL BORDER CROSSINGS (BORDER CROSSINGS)
C19   XUBCM = INITIAL UNSUCCESSFUL BORDER CROSSINGS (BORDER CROSSINGS)
C20   XVM = INITIAL VIOLENCE (BATTLES)
 
      CALL DEVIATE(1,XBCNR,XBCNRM)
      CALL DEVIATE(2,XBCRR,XBCRRM)
      CALL DEVIATE(3,XB,XBM)
      CALL DEVIATE(4,XDFD,XDFDM)
      CALL DEVIATE(5,XDFS,XDFSM)
      CALL DEVIATE(6,XDFU,XDFUM)
      CALL DEVIATE(7,XDFV,XDFVM)
      CALL DEVIATE(8,XDE,XDEM)
      CALL DEVIATE(9,XF,XFM)
      CALL DEVIATE(10,XIO,XIOM)
      CALL DEVIATE(11,XMP,XMPM)
      CALL DEVIATE(12,XP,XPM)
      CALL DEVIATE(13,XPFC,XPFCM)
      CALL DEVIATE(14,XPWD,XPWDM)
      CALL DEVIATE(15,XR,XRM)
      CALL DEVIATE(16,XRI,XRIM)
      CALL DEVIATE(17,XSH,XSHM)
      CALL DEVIATE(18,XSBC,XSBCM)
      CALL DEVIATE(19,XUBC,XUBCM)
      CALL DEVIATE(20,XV,XVM)


C***********************************************************************
C     MIDDLE NORMAL VALUES
C21     YABCM   = NORMAL ATTEMPTED BORDER CROSSINGS PER MONTH 
C              (BORDER CROSSINGS/MONTH)
C22     YBRM    = NORMAL BIRTH RATE 
C              (FAMILIES/FAMILIES/MONTH)
C23     YBCNRM  = NORMAL BORDER CONTROL RESOURCES 
C              (BOATS)
C24     YBCRRM  = NORMAL BORDER CROSSING RESOURCES 
C              (BOATS)
C25     YDRFDM  = NORMAL DEATH RATE FROM DISEASE 
C              (FAMILIES/FAMILIES/MONTH)
C26     YDRFSM  = NORMAL DEATH RATE FROM STARVATION 
C              (FAMILIES/FAMILIES/MONTH)
C27     YDRFVM  = NORMAL DEATH RATE FROM VIOLENCE 
C              (FAMILIES/FAMILIES/MONTH)
C28     YDMM    = NORMAL DEATHS PER MONTH 
C              (FAMILIES/MONTH)
C29     YDUBCM  = NORMAL DEATHS PER MONTH FROM UNSUCCESSFUL BORDER 
C              CROSSINGS (FAMILIES/MONTH)
C30     YPSHM   = NORMAL FAMILIES IN SAFE HAVENS
C              (FAMILIES)
C31     YFBCM   = NORMAL FAMILIES PER BORDER CROSSING 
C              (FAMILIES)
C32     YFM     = NORMAL FOOD 
C              (FOOD UNITS)
C33     YFGRM   = NORMAL FOOD GROWTH RATE 
C              (FOOD UNITS/FOOD UNIT/MONTH)
C34     YFUBCM  = NORMAL FRACTION OF UNSUCCESSFUL BORDER CROSSINGS 
C              (DMNL)
C35     YIRM    = NORMAL INFECTION RATE 
C              (FAMILIES/FAMILIES/MONTH)
C36     YPRSHM  = NORMAL PEACEKEEPERS REQUIRED TO PROTECT SAFE HAVEN
C              (SOLDIERS)
C37     YRM     = NORMAL REFUGEES
C              (FAMILIES)
C38     YSBCM   = NORMAL SUCCESSFUL BORDER CROSSINGS PER MONTH
C              (BORDER CROSSINGS/MONTH)
C39     YTCSHM  = NORMAL TIME TO CREATE A SAFE HAVEN
C              (MONTHS)
C40     YTDLFCM = NORMAL TIME TO DECIDE TO LEAVE FOREIGN COUNTRY
C              (MONTHS)
C41     YTDSHM  = NORMAL TIME TO DESTROY A SAFE HAVEN
C              (MONTHS)
C42     YTDBM   = NORMAL TIME TO DESTROY A BUSINESS
C              (MONTHS)
C43     YTIM    = NORMAL TOTAL INVESTMENT
C              (MILLION DOLLARS/MONTH)
C44     YUBCM   = NORMAL UNSUCCESSFUL BORDER CROSSINGS PER MONTH
C              (BORDER CROSSINGS/MONTH)
C45     YVRDBM  = NORMAL VIOLENCE REQUIRED TO DESTROY A BUSINESS
C              (BATTLES)
C46     YVRDSHM = NORMAL VIOLENCE REQUIRED TO DESTROY A SAFE HAVEN
C              (BATTLES)
C47     YVRDHM  = NORMAL VIOLENCE REQUIRED TO DESTROY HARVEST
C              (BATTLES)
C48     YVRDFAM = NORMAL VIOLENCE REQUIRED TO DISRUPT DELIVERY OF FOOD
C              AID (BATTLES)

      CALL DEVIATE(21,YABC,YABCM)
      CALL DEVIATE(22,YBR,YBRM)
      CALL DEVIATE(23,YBCNR,YBCNRM)
      CALL DEVIATE(24,YBCRR,YBCRRM)     
      CALL DEVIATE(25,YDRFD,YDRFDM)
      CALL DEVIATE(26,YDRFS,YDRFSM)
      CALL DEVIATE(27,YDRFV,YDRFVM)
      CALL DEVIATE(28,YDM,YDMM)
      CALL DEVIATE(29,YDUBC,YDUBCM)
      CALL DEVIATE(30,YPSH,YPSHM)
      CALL DEVIATE(31,YFBC,YFBCM)
      CALL DEVIATE(32,YF,YFM)
      CALL DEVIATE(33,YFGR,YFGRM)
      CALL DEVIATE(34,YFUBC,YFUBCM)
      CALL DEVIATE(35,YIR,YIRM)
      CALL DEVIATE(36,YPRSH,YPRSHM)
      CALL DEVIATE(37,YR,YRM)
      CALL DEVIATE(38,YSBC,YSBCM)
      CALL DEVIATE(39,YTCSH,YTCSHM)
      CALL DEVIATE(40,YTDLFC,YTDLFCM)
      CALL DEVIATE(41,YTDSH,YTDSHM)
      CALL DEVIATE(42,YTDB,YTDBM)
      CALL DEVIATE(43,YTI,YTIM)
      CALL DEVIATE(44,YUBC,YUBCM)
      CALL DEVIATE(45,YVRDB,YVRDBM)
      CALL DEVIATE(46,YVRDSH,YVRDSHM)
      CALL DEVIATE(47,YVRDH,YVRDHM)
      CALL DEVIATE(48,YVRDFA,YVRDFAM)

C***********************************************************************
C     MIDDLE VALUES FOR THE CONSTANTS
C
C49   ACPFM   = AVERAGE CONSUMPTION PER FAMILY
C            (FOOD UNITS/FAMILIES/MONTH)
C50   ACBCRM  = AVERAGE COST OF BORDER CONTROL RESOURCES
C            (MILLION DOLLARS/BOATS/MONTH)
C51   ACDEM   = AVERAGE COST OF DIPLOMATIC EFFORT
C            (MILLION DOLLARS/DIPLOMATS/MONTH)
C52   ACFUM   = AVERAGE COST OF A FOOD UNIT
C            (MILLION DOLLARS/FOOD UNIT)
C53   ACIOM   = AVERAGE COST OF IMMIGRATION OFFICERS
C            (MILLION DOLLARS/OFFICERS/MONTH)
C54   ACMPM   = AVERAGE COST OF MEDICAL PRACTITIONERS
C            (MILLION DOLLARS/DOCTORS/MONTH)
C55   ACPM    = AVERAGE COST OF PEACEKEEPERS
C           (MILLION DOLLARS/SOLDIER/MONTH)
C56   ACSBM   = AVERAGE COST TO SETUP A BUSINESS
C            (MILLION DOLLARS/BUSINESSES)
C57   ADCCFM  = AVERAGE DIPLOMATS TO CREATE A CEASE FIRE
C            (DIPLOMATS/BATTLES)
C58   AJBM    = AVERAGE JOBS PER BUSINESS
C           (FAMILIES/BUSINESSES)
C59   ALEM    = AVERAGE LIFE EXPECTENCY
C            (MONTHS)
C60   APRBM   = AVERAGE PEACEKEEPERS TO REDUCE A BATTLE
C            (SOLDIERS/BATTLES)
C61   APMPM   = AVERAGE PEOPLE A MEDICAL PRACTITIONER CAN HANDLE
C            (FAMILIES/DOCTORS)
C62   APSHM   = AVERAGE POPULATION PER SAFE HAVEN
C            (FAMILIES/HAVENS)
C63   ATABCRM = AVERAGE TIME TO ADD BORDER CROSSING RESOURCES
C            (MONTHS)
C64   ATCVLM  = AVERAGE TIME TO CHANGE VIOLENCE LEVEL
C            (MONTHS)
C65   ATCDM   = AVERAGE TIME TO CURE DISEASE
C            (MONTHS)
C66   ATDBCRM = AVERAGE TIME TO DEPLOY BORDER CONTROL RESOURCES
C            (MONTHS)
C67   ATDPM   = AVERAGE TIME TO DEPLOY PEACEKEEPERS
C            (MONTHS)
C68   ATEDM   = AVERAGE TIME TO EMPLOY DIPLOMATS
C            (MONTHS)
C69   ATHMPM  = AVERAGE TIME TO HIRE MEDICAL PRACTITIONER
C            (MONTHS)
C70   ATPIPM  = AVERAGE TIME TO PROCESS IMMIGRATION PAPERS
C            (MONTHS)
C71   ATTIOM  = AVERAGE TIME TO TRAIN IMMIGRATION OFFICERS
C            (MONTHS)
C72   BMBCM   = BOAT MONTHS PER BORDER CROSSING
C            (BOATS*MONTHS)/BORDER CROSSING
C73   FPIOM   = FAMILIES PROCESSED AT SAME TIME BY IMMIGRATION OFFICER
C            (FAMILIES/IMMIGRATION OFFICERS)
C74   FDUBCM  = FRACTION OF DEATHS PER UNSUCCESSFUL BORDER CROSSING
C            (DMNL)
C75   VERM    = VIOLENCE ESCALATION RATE
C            (DMNL)

      CALL DEVIATE(49,ACPF,ACPFM)
      CALL DEVIATE(50,ACBCR,ACBCRM)
      CALL DEVIATE(51,ACDE,ACDEM)
      CALL DEVIATE(52,ACFU,ACFUM)
      CALL DEVIATE(53,ACIO,ACIOM)
      CALL DEVIATE(54,ACMP,ACMPM)
      CALL DEVIATE(55,ACP,ACPM)
      CALL DEVIATE(56,ACS,ACSBM)
      CALL DEVIATE(57,ADCCF,ADCCFM)
      CALL DEVIATE(58,AJB,AJBM)
      CALL DEVIATE(59,ALE,ALEM)
      CALL DEVIATE(60,APRB,APRBM)
      CALL DEVIATE(61,APMP,APMPM)
      CALL DEVIATE(62,APSH,APSHM)
      CALL DEVIATE(63,ATABCR,ATABCRM)
      CALL DEVIATE(64,ATCVL,ATCVLM)
      CALL DEVIATE(65,ATCD,ATCDM)
      CALL DEVIATE(66,ATDBCR,ATDBCRM)
      CALL DEVIATE(67,ATDP,ATDPM)
      CALL DEVIATE(68,ATED,ATEDM)
      CALL DEVIATE(69,ATHMP,ATHMPM)
      CALL DEVIATE(70,ATPIP,ATPIPM)
      CALL DEVIATE(71,ATTIO,ATTIOM)
      CALL DEVIATE(72,BMBC,BMBCM)
      CALL DEVIATE(73,FPIO,FPIOM)
      CALL DEVIATE(74,FDUBC,FDUBCM)
      CALL DEVIATE(75,VER,VERM)

C***********************************************************************      
C    MIDDLE TABLE FUNCTION VALUES
C
C76     EBCRABT = EFFECT OF BORDER CONTRL ON ATTEMPTED BORDER CROSSINGS
C               PER MONTH
C77     EBCRACT = EFFECT OF BORDER CROSSING RESOURCES ON ATTEMPTED BORDER
C               CROSSINGS PER MONTH TABLE
C78     EBCRFCT = EFFECT OF BORDER CROSSING RESOURCES ON FAMILIES PER
C               BORDER CROSSING TABLE
C79     EBCRUCT = EFFECT OF BORDER CROSSING RESOURCES ON FRACTION OF 
C               UNSUCCESSFUL BORDER CROSSINGS TABLE
C80	EOCODRT = EFFECT OF CROWDING ON DISEASE RATE 
C               TABLE
C81     EDFIBCT = EFFECT OF DEATHS PER MONTH ON FRACTION OF INVESTMENT IN
C               BORDER CONTROL TABLE
C82     EDPMTIT = EFFECT OF DEATHS PER MONTH ON TOTAL INVESTMENT 
C               TABLE
C83     EDFIHST = EFFECT OF DISEASE ON FRACTION OF INVESTMENT ON HEALTH
C               SERVICES TABLE
C84     EFFIFAT = EFFECT OF FAMINE ON FRACTION OF INVESTMENT IN FOOD AID
C               TABLE
C85     EPTCSHT = EFFECT OF PEACEKEEPERS ON TIME TO CREATE SAFE HAVEN
C               TABLE
C86     ERTDLCT = EFFECT OF PEOPLE AT RISK ON AVERAGE TIME TO DECIDE TO 
C               LEAVE FOREIGN COUNTRY TABLE
C87     EPDOTIT = EFFECT OF PEOPLE IN DANGER ON TOTAL INVESTMENT 
C               TABLE
C88     ERABCMT = EFFECT OF REFUGEES ON ATTEMPTED BORDER CROSSINGS PER 
C               MONTH TABLE
C89     ERDBCRT = EFFECT OF REFUGEES ON DESIRED BORDER CROSSING RESOURCES 
C               TABLE
C90     ERFIIIT = EFFECT OF REFUGEES ON FRACTION OF INVESTMENT IN 
C               IMMIGRATION TABLE
C91     ESBCBCT = EFFECT OF SUCCESSFUL BORDER CROSSINGS ON ATTEMPTED 
C               BORDER CROSSINGS PER MONTH TABLE
C92     EUBCBCT = EFFECT OF UNSUCCESSFUL BORDER CROSSINGS ON ATTEMPTED 
C               BORDER CROSSING PER MONTH TABLE
C93     EVODFAT = EFFECT OF VIOLENCE ON DISTRIBUTION OF FOOD AID
C               TABLE
C94     EVIOFMT = EFFECT OF VIOLENCE ON FAMINE 
C               TABLE
C95     EVFIDPT = EFFECT OF VIOLENCE ON FRACTION OF INVESTMENT ON 
C               DIPLOMACY TABLE
C96     EVFIPKT = EFFECT OF VIOLENCE ON FRACTION OF INVESTMENT IN 
C               PEACEKEEPING TABLE
C97     EVITDBT = EFFECT OF VIOLENCE ON TIME TO DESTROY A BUSINESS
C               TABLE
C98     EVTDSHT = EFFECT OF VIOLENCE ON TIME TO DESTROY A SAFE HAVEN
C               TABLE	

      CALL DEVIATE(76,EBCRABT(2,1),EBCRABM)
      CALL DEVIATE(77,EBCRACT(2,1),EBCRACM)
      CALL DEVIATE(78,EBCRFCT(2,1),EBCRFCM)
      CALL DEVIATE(79,EBCRUCT(2,1),EBCRUCM)
      CALL DEVIATE(80,EOCODRT(2,1),EOCODRM)
      CALL DEVIATE(81,EDFIBCT(2,1),EDFIBCM)
      CALL DEVIATE(82,EDPMTIT(2,1),EDPMTIM)
      CALL DEVIATE(83,EDFIHST(2,1),EDFIHSM)
      CALL DEVIATE(84,EFFIFAT(2,1),EFFIFAM)
      CALL DEVIATE(85,EPTCSHT(2,1),EPTCSHM)
      CALL DEVIATE(86,ERTDLCT(2,1),ERTDLCM)
      CALL DEVIATE(87,EPDOTIT(2,1),EPDOTIM)
      CALL DEVIATE(88,ERABCMT(2,1),ERABCMM)
      CALL DEVIATE(89,ERDBCRT(2,1),ERDBCRM)
      CALL DEVIATE(90,ERFIIIT(2,1),ERFIIIM)
      CALL DEVIATE(91,ESBCBCT(2,1),ESBCBCM)
      CALL DEVIATE(92,EUBCBCT(2,1),EUBCBCM)
      CALL DEVIATE(93,EVODFAT(2,1),EVODFAM)
      CALL DEVIATE(94,EVIOFMT(2,1),EVIOFMM)
      CALL DEVIATE(95,EVFIDPT(2,1),EVFIDPM)
      CALL DEVIATE(96,EVFIPKT(2,1),EVFIPKM)
      CALL DEVIATE(97,EVITDBT(2,1),EVITDBM)
      CALL DEVIATE(98,EVTDSHT(2,1),EVTDSHM)
       
      RETURN
      END  

C***********************************************************************
 
      SUBROUTINE DEVIATE(I,X,XM)

C     SET TO EITHER HIGH OR LOW VALUES
C     HIGH VALUES ARE TWICE THE INPUT CODED 1
C     LOW VALUES ARE HALF THE INPUT CODED -1
C

      IMPLICIT DOUBLE PRECISION (A-H, O-Z)
      
      INCLUDE 'COMVAR.DCL'
      INCLUDE 'DOEVAR.DCL'
 
      J = INT(RAND()+0.5)
      IF (J .EQ. 0) THEN
         X = XM / 2.0
         N(I) = -1
      ELSE
         X = XM * 2.0
         N(I) = 1
      ENDIF

      RETURN
      END

C***********************************************************************
 
      SUBROUTINE UDEVIATE(I,X,XM)

C     SET TO INITIAL VALUE
C

      IMPLICIT DOUBLE PRECISION (A-H, O-Z)

      INCLUDE 'COMVAR.DCL'
      INCLUDE 'DOEVAR.DCL'

      X = XM
      N(I) = 0

      RETURN
      END

C***********************************************************************
C
      SUBROUTINE RUNSIM(CAD)

      IMPLICIT DOUBLE PRECISION (A-H, O-Z)

      INCLUDE 'COMVAR.DCL'
      INCLUDE 'DOEVAR.DCL'


C***********************************************************************
C
C     WRITE STATE VARIABLE HEADINGS


C      WRITE(6,1030)
C1030  FORMAT('           TIME           BCNR           BCRR',
C     1       '              B            DFD            DFS',
C     1       '            DFU            DFV             DE',
C     1       '              F            ZIO            ZMP',
C     1       '              P            PFC            PWD',
C     1       '              R             RI             SH',
C     1       '            SBC            UBC              V')

C***********************************************************************
C     SET STATE VARIABLES TO INITIAL VALUES
C
C01   XBCNR = INITIAL BORDER CONTROL RESOURCES (BOATS)
C02   XBCRR = INITIAL BORDER CROSSING RESOURCES (BOATS)
C03   XB = INITIAL BUSINESSES (BUSINESSES)
C04   XDFD = INITIAL DEATHS FROM DISEASE (FAMILIES)
C05   XDFS = INITIAL DEATHS FROM STARVATION (FAMILIES)
C06   XDFU = INITIAL DEATHS FROM UNSUCCESSFUL BORDER CROSSINGS (FAMILIES)
C07   XDFV = INITIAL DEATHS FROM VIOLENCE (FAMILIES)
C08   XDE = INITIAL DIPLOMATIC EFFORT (DIPLOMATS)
C09   XF = INITIAL FOOD (FOOD UNITS)
C10   XIO = INITIAL IMMIGRATION OFFICERS (OFFICERS)
C11   XMP = INITIAL MEDICAL PRACTITIONERS (DOCTORS)
C12   XP = INITIAL PEACEKEEPERS (SOLDIERS)
C13   XPFC = INITIAL POPULATION IN FOREIGN COUNTRY (FAMILIES)
C14   XPWD = INITIAL POPULATION WITH DISEASE (FAMILIES)
C15   XR = INITIAL REFUGEES (FAMILIES)
C16   XRI = INITIAL REFUGEES WHO HAVE IMMIGRATED (FAMILIES)
C17   XSH = INITIAL SAFE HAVENS (HAVENS)
C18   XSBC = INITIAL SUCCESSFUL BORDER CROSSINGS (BORDER CROSSINGS)
C19   XUBC = INITIAL UNSUCCESSFUL BORDER CROSSINGS (BORDER CROSSINGS)
C20   XV = INITIAL VIOLENCE (BATTLES)


      BCNR(1) = XBCNR
      BCRR(1) = XBCRR
      B(1)    = XB
      DFD(1)  = XDFD
      DFS(1)  = XDFS
      DFU(1)  = XDFU
      DFV(1)  = XDFV
      DE(1)   = XDE
      F(1)    = XF
      ZIO(1)  = XIO
      ZMP(1)  = XMP
      P(1)    = XP
      PFC(1)  = XPFC
      PWD(1)  = XPWD
      R(1)    = XR
      RI(1)   = XRI
      SH(1)   = XSH
      SBC(1)  = XSBC
      UBC(1)  = XUBC
      V(1)    = XV

      TIME = 0.0

C***********************************************************************
C     RUN SIMULATION


10    IF (TIME .GT. ENDTIME) GO TO 20

C***********************************************************************
C
C     WRITE STATE VARIABLES AT UNIT TIME INTERVALS


C      IF ((TIME-INT(TIME)) .LT. 0.001) WRITE(6,1040) TIME,BCNR(1),
C     1 BCRR(1),B(1),DFD(1),DFS(1),DFU(1),DFV(1),DE(1),F(1),ZIO(1),
C     1 ZMP(1),P(1),PFC(1),PWD(1),R(1),RI(1),SH(1),SBC(1),UBC(1),V(1)
C1040  FORMAT(21F15.3)


C***********************************************************************
C
C     COMPUTE TI = TOTAL INVESTMENT (MILLION DOLLARS/MONTH)
C
C               
C PEF    = POPULATION WITH ENOUGH FOOD (FAMILIES)
C F      = FOOD (FOOD UNITS)
C ACPF   = AVERAGE COMSUMPTION PER FAMILY PER MONTH 
C             (FOOD UNITS/FAMILY/MONTH)
C PFC    = POPULATION IN FOREIGN COUNTRY (FAMILIES)             

      IF ((F(1) / ACPF).GE.PFC(1)) THEN
         PEF = PFC(1)
      ELSE
         PEF = F(1) / ACPF
      ENDIF

C PSH    = POPULATION IN SAFE HAVENS (FAMILIES)
C SH     = SAFE HAVENS (HAVENS)
C APSH   = AVERAGE POPULATION PER SAFE HAVEN (FAMILIES/HAVEN)
C PFC    = POPULATION IN FOREIGN COUNTRY (FAMILIES)

      IF ((SH(1) * APSH).GE.PFC(1)) THEN
         PSH = PFC(1)
      ELSE
         PSH = SH(1) * APSH
      ENDIF      

C PWJ    = POPULATION WITH JOBS (FAMILIES)
C B      = BUSINESSES (BUSINESSES)
C AJB    = AVERAGE JOBS PER BUSINESS (FAMILIES/BUSINESS)

      PWJ = B(1) * AJB

C PWOD   = POPULATION WITHOUT DISEASE (FAMILIES)
C PFC    = POPULATION IN FOREIGN COUNTRY (FAMILIES)
C PWD    = POPULATION WITH DISEASE

      PWOD = PFC(1) - PWD(1)

C PU     = POPULATION UNAFFECTED (FAMILIES)
C PEF    = POPULATION WITH ENOUGH FOOD (FAMILIES)
C PSH    = POPULATION IN SAFE HAVENS (FAMILIES)
C PWJ    = POPULATION WITH JOBS (FAMILIES)
C PWOD   = POPULATION WITHOUT DISEASE (FAMILIES)

      PU  = DMIN1(PEF, PSH, PWJ, PWOD)

C ADFSM  = AVERAGE DEATHS FROM STARVATION PER MONTH (FAMILIES/MONTH)
C DFS    = DEATHS FROM STARVATION (FAMILIES)

      IF (TIME .GT. 0.0) THEN
         ADFSM = DFS(1) / TIME
      ELSE
         ADFSM = 0.0
      ENDIF

C ADFVM  = AVERAGE DEATHS FROM VIOLENCE PER MONTH (FAMILIES/MONTH)
C DFV    = DEATHS FROM VIOLENCE (FAMILIES)

      IF (TIME .GT. 0.0) THEN
         ADFVM = DFV(1) / TIME
      ELSE
         ADFVM = 0.0
      ENDIF

C ADFDM  = AVERAGE DEATHS FROM DISEASE PER MONTH (FAMILIES/MONTH)
C DFD    = DEATHS FROM DISEASE (FAMILIES)

      IF (TIME .GT. 0.0) THEN
         ADFDM = DFD(1) / TIME
      ELSE
         ADFDM = 0.0
      ENDIF

C ADFUM  = AVERAGE DEATHS FROM UNSUCCESSFUL BORDER CROSSING PER MONTH
C         (FAMILIES/MONTH)
C DFU    = DEATHS FROM UNSUCCESSFUL BORDER CROSSING (FAMILIES)

      IF (TIME .GT. 0.0) THEN
         ADFUM = DFU(1) / TIME
      ELSE
         ADFUM = 0.0
      ENDIF

C ADM    = AVOIDABLE DEATHS PER MONTH (FAMILIES)
C ADFSM  = AVERAGE DEATHS FROM STARVATION PER MONTH (FAMILIES/MONTH)
C ADFVM  = AVERAGE DEATHS FROM VIOLENCE PER MONTH (FAMILIES/MONTH)
C ADFDM  = AVERAGE DEATHS FROM DISEASE PER MONTH (FAMILIES/MONTH)
C ADFUM  = AVERAGE DEATHS FROM UNSUCCESSFUL BORDER CROSSING PER MONTH
C         (FAMILIES/MONTH)

      ADM = ADFSM + ADFVM + ADFDM + ADFUM

C EPDOTI = EFFECT OF PEOPLE IN DANGER ON TOTAL INVESTMENT (DMNL)
C PFC    = POPULATION IN FOREIGN COUNTRIES (FAMILIES)
C PU     = POPULATION UNAFFECTED (FAMILIES)

      EPDOTI = TABLE(EPDOTIT,(PFC(1) - PU) / PFC(1))

C EDPMTI = EFFECT OF DEATHS PER MONTH ON TOTAL INVESTMENT (DMNL)
C ADM    = AVOIDABLE DEATHS PER MONTH (FAMILIES/MONTH)
C YDM    = NORMAL DEATHS PER MONTH (FAMILIES/MONTH)

      EDPMTI = TABLE(EDPMTIT,ADM / YDM)

C TI     = TOTAL INVESTMENT (MILLION DOLLARS/MONTH)
C YTI    = NORMAL TOTAL INVESTMENT
C EPDOTI = EFFECT OF PEOPLE IN DANGER ON TOTAL INVESTMENT (DMNL)
C EDPMTI = EFFECT OF DEATHS PER MONTH ON TOTAL INVESTMENT (DMNL)

      TI = YTI * EPDOTI * EDPMTI

      
C***********************************************************************
C
C     COMPUTE AIBC = ALLOCATION OF INVESTMENT TO BORDER CONTROL
C                    (MILLION DOLLARS/MONTH)
C
C
C EDFIBC = EFFECT OF DEATHS PER MONTH ON FRACTION OF INVESTMENT IN
C          BORDER CONTROL (DMNL)
C ADFUM  = AVERAGE DEATHS FROM UNSUCCESSFUL BORDER CROSSING PER MONTH
C         (FAMILIES/MONTH)
C YDUBC  = NORMAL DEATHS PER MONTH FROM UNSUCCESSFUL BORDER CROSSINGS
C          (FAMILIES/MONTH)

      EDFIBC = TABLE(EDFIBCT,ADFUM / YDUBC)

C FIBC   = FRACTION OF INVESTMENT IN BORDER CONTROL (DMNL)
C EDFIBC = EFFECT OF DEATHS PER MONTH ON FRACTION OF INVESTMENT IN
C          BORDER CONTROL (DMNL)

      FIBC = EDFIBC

C AIBC   = ALLOCATION OF INVESTMENT TO BORDER CONTROL
C          (MILLION DOLLARS/MONTH)
C FIBC   = FRACTION OF INVESTMENT IN BORDER CONTROL (DMNL)
C TI     = TOTAL INVESTMENT (MILLION DOLLARS/MONTH)

      AIBC = FIBC * TI


C***********************************************************************
C
C     COMPUTE AIFA = ALLOCATION OF INVESTMENT TO FOOD AID
C                    (MILLION DOLLARS/MONTH)
C

C EFFIFA = EFFECT OF FAMINE ON FRACTION OF INVESTMENT IN FOOD AID
C         (DMNL)
C PFC    = POPULATION IN FOREIGN COUNTRIES (FAMILIES)
C PEF    = POPULATION WITH ENOUGH FOOD (FAMILIES)

      EFFIFA = TABLE(EFFIFAT,(PFC(1) - PEF) / PFC(1))

C DFIFA  = DESIRED FRACTION OF INVESTMENT IN FOOD AID (DMNL)
C EFFIFA = EFFECT OF FAMINE ON FRACTION OF INVESTMENT IN FOOD AID
C          (DMNL)

      DFIFA = EFFIFA

C FRIFA  = FRACTION OF REMAINING INVESTMENT ON FOOD AID (DMNL)
C DFIFA  = DESIRED FRACTION OF INVESTMENT IN FOOD AID (DMNL)
C FIBC   = FRACTION OF INVESTMENT IN BORDER CONTROL (DMNL)

      FRIFA = DMIN1(DFIFA, DMAX1(0.0,(1.0 - FIBC)))

C AIFA   = ALLOCATION OF INVESTMENT TO FOOD AID
C          (MILLION DOLLARS/MONTH)
C FRIFA  = FRACTION OF REMAINING INVESTMENT ON FOOD AID (DMNL)
C TI     = TOTAL INVESTMENT (MILLION DOLLARS/MONTH)

      AIFA = FRIFA * TI

C***********************************************************************
C
C     COMPUTE AIHS = ALLOCATION OF INVESTMENT TO HEALTH SERVICES
C                    (MILLION DOLLARS/MONTH)
C

C EDFIHS = EFFECT OF DISEASE ON FRACTION OF INVESTMENT IN HEALTH 
C          SERVICES (DMNL)
C PFC    = POPULATION IN FOREIGN COUNTRIES (FAMILIES)
C PWOD   = POPULATION WITHOUT DISEASE (FAMILIES)

      EDFIHS = TABLE(EDFIHST,(PFC(1) - PWOD) / PFC(1))

C DFIHS  = DESIRED FRACTION OF INVESTMENT IN PEACEKEEPING (DMNL)
C EDFIHS = EFFECT OF DISEASE ON FRACTION OF INVESTMENT IN HEALTH
C          SERVICES (DMNL)

      DFIHS = EDFIHS

C FRIHS  = FRACTION OF REMAINING INVESTMENT ON HEALTH SERVICES (DMNL)
C DFIHS  = DESIRED FRACTION OF INVESTMENT IN HEALTH SERVICES (DMNL)
C FIBC   = FRACTION OF INVESTMENT IN BORDER CONTROL (DMNL)
C FRIFA  = FRACTION OF REMAINING INVESTMENT ON FOOD AID (DMNL)

      FRIHS = DMIN1(DFIHS, DMAX1(0.0,(1.0 - FIBC - FRIFA)))

C AIP    = ALLOCATION OF INVESTMENT TO PEACEKEEPING
C          (MILLION DOLLARS/MONTH)
C FRIP   = FRACTION OF REMAINING INVESTMENT ON PEACEKEEPING (DMNL)
C TI     = TOTAL INVESTMENT (MILLION DOLLARS/MONTH)

      AIHS = FRIHS * TI

C***********************************************************************
C
C     COMPUTE AID = ALLOCATION OF INVESTMENT TO DIPLOMACY
C                    (MILLION DOLLARS/MONTH)
C

C EVFIDP = EFFECT OF VIOLENCE ON FRACTION OF INVESTMENT ON 
C          DIPLOMACY (DMNL)
C PFC    = POPULATION IN FOREIGN COUNTRIES (FAMILIES)
C PSH    = POPULATION IN SAFE HAVENS (FAMILIES)

      EVFIDP = TABLE(EVFIDPT,(PFC(1) - PSH) / PFC(1))

C DFID   = DESIRED FRACTION OF INVESTMENT IN DIPLOMACY (DMNL)
C EVFIDP = EFFECT OF VIOLENCE ON FRACTION OF INVESTMENT ON 
C          DIPLOMACY (DMNL)

      DFID = EVFIDP

C FRID   = FRACTION OF REMAINING INVESTMENT ON DIPLOMACY (DMNL)
C DFID   = DESIRED FRACTION OF INVESTMENT IN DIPLOMACY (DMNL)
C FIBC   = FRACTION OF INVESTMENT IN BORDER CONTROL (DMNL)
C FRIFA  = FRACTION OF REMAINING INVESTMENT ON FOOD AID (DMNL)
C FRIHS  = FRACTION OF REMAINING INVESTMENT ON HEALTH SERVICES (DMNL)

      FRID = DMIN1(DFID, DMAX1(0.0,(1.0 - FIBC - FRIFA - FRIHS)))

C AID    = ALLOCATION OF INVESTMENT TO DIPLOMACY
C          (MILLION DOLLARS/MONTH)
C FRID   = FRACTION OF REMAINING INVESTMENT ON DIPLOMACY (DMNL)
C TI     = TOTAL INVESTMENT (MILLION DOLLARS/MONTH)

      AID = FRID * TI

C***********************************************************************
C
C     COMPUTE AIP = ALLOCATION OF INVESTMENT TO PEACEKEEPING
C                    (MILLION DOLLARS/MONTH)
C

C EVFIPK = EFFECT OF VIOLENCE ON FRACTION OF INVESTMENT IN 
C          PEACEKEEPING (DMNL)
C PFC    = POPULATION IN FOREIGN COUNTRIES (FAMILIES)
C PSH    = POPULATION IN SAFE HAVENS (FAMILIES)

      EVFIPK = TABLE(EVFIPKT,(PFC(1) - PSH) / PFC(1))

C DFIP   = DESIRED FRACTION OF INVESTMENT IN PEACEKEEPING (DMNL)
C EVFIPK = EFFECT OF VIOLENCE ON FRACTION OF INVESTMENT IN 
C          PEACEKEEPING (DMNL)

      DFIP = EVFIPK

C FRIP   = FRACTION OF REMAINING INVESTMENT ON PEACEKEEPING (DMNL)
C DFIP   = DESIRED FRACTION OF INVESTMENT IN PEACEKEEPING (DMNL)
C FIBC   = FRACTION OF INVESTMENT IN BORDER CONTROL (DMNL)
C FRIFA  = FRACTION OF REMAINING INVESTMENT ON FOOD AID (DMNL)
C FRIHS  = FRACTION OF REMAINING INVESTMENT ON HEALTH SERVICES (DMNL)
C FRID   = FRACTION OF REMAINING INVESTMENT ON DIPLOMACY (DMNL)

      FRIP = DMIN1(DFIP, DMAX1(0.0,
     1 (1.0 - FIBC - FRIFA - FRIHS - FRID)))

C AIP    = ALLOCATION OF INVESTMENT TO PEACEKEEPING
C          (MILLION DOLLARS/MONTH)
C FRIP   = FRACTION OF REMAINING INVESTMENT ON PEACEKEEPING (DMNL)
C TI     = TOTAL INVESTMENT (MILLION DOLLARS/MONTH)

      AIP = FRIP * TI

C***********************************************************************
C
C     COMPUTE AII = ALLOCATION OF INVESTMENT TO IMMIGRATION
C                    (MILLION DOLLARS/MONTH)
C
C ERFIII = EFFECT OF REFUGEES ON FRACTION OF INVESTMENT IN 
C          IMMIGRATION (DMNL)
C R      = REFUGEES (FAMILIES)
C YR     = NORMAL REFUGEES (FAMILIES)

      ERFIII = TABLE(ERFIIIT, R(1) / YR)

C DFII   = DESIRED FRACTION OF INVESTMENT ON IMMIGRATION (DMNL)
C ERFIII = EFFECT OF REFUGEES ON FRACTION OF INVESTMENT IN 

      DFII = ERFIII

C FRII   = FRACTION OF REMAINING INVESTMENT ON IMMIGRATION (DMNL)
C DFII   = DESIRED FRACTION OF INVESTMENT ON IMMIGRATION (DMNL)
C FIBC   = FRACTION OF INVESTMENT IN BORDER CONTROL (DMNL)
C FRIFA  = FRACTION OF REMAINING INVESTMENT ON FOOD AID (DMNL)
C FRIHS  = FRACTION OF REMAINING INVESTMENT ON HEALTH SERVICES (DMNL)
C FRID   = FRACTION OF REMAINING INVESTMENT ON DIPLOMACY (DMNL)
C FRIP   = FRACTION OF REMAINING INVESTMENT ON PEACEKEEPING (DMNL)

      FRII = DMIN1(DFII,DMAX1(0.0,
     1 (1.0 - FIBC - FRIFA - FRIHS - FRID - FRIP)))


C AII    = ALLOCATION OF INVESTMENT TO IMMIGRATION
C          (MILLION DOLLARS/MONTH)
C FRII   = FRACTION OF REMAINING INVESTMENT ON IMMIGRATION (DMNL)
C TI     = TOTAL INVESTMENT (MILLION DOLLARS/MONTH)

      AII = FRII * TI


C***********************************************************************
C
C     COMPUTE AIED = ALLOCATION OF INVESTMENT TO ECONOMIC DEVELOPMENT
C                    (MILLION DOLLARS/MONTH)
 
C AIED   = ALLOCATION OF INVESTMENT TO ECONOMIC DEVELOPMENT
C          (MILLION DOLLARS/MONTH)
C TI     = TOTAL INVESTMENT (MILLION DOLLARS/MONTH)
C AIBC   = ALLOCATION OF INVESTMENT TO BORDER CONTROL
C          (MILLION DOLLARS/MONTH)
C AIFA   = ALLOCATION OF INVESTMENT TO FOOD AID
C          (MILLION DOLLARS/MONTH)
C AIHS   = ALLOCATION OF INVESTMENT TO HEALTH SERVICES
C          (MILLION DOLLARS/MONTH)
C AID    = ALLOCATION OF INVESTMENT TO DIPLOMACY
C          (MILLION DOLLARS/MONTH)
C AIP    = ALLOCATION OF INVESTMENT TO PEACEKEEPING
C          (MILLION DOLLARS/MONTH)
C AII    = ALLOCATION OF INVESTMENT TO IMMIGRATION
C          (MILLION DOLLARS/MONTH)

      AIED = DMAX1(0.0,(TI - AIBC - AIFA - AIHS - AID - AIP - AII))

      
C***********************************************************************
C
C     COMPUTE BCRR = BORDER CROSSING RESOURCES (BOATS)


C ERDBCR = EFFECT OF REFUGEES ON DESIRED BORDER CROSSING RESOURCES (DMNL) 
C R      = REFUGEES (FAMILIES)
C YR     = NORMAL REFUGEES (FAMILIES)

      ERDBCR = TABLE(ERDBCRT, R(1) / YR)

C DBCR   = DESIRED BORDER CROSSING RESOURCES (BOATS)
C YBCRR  = NORMAL BORDER CROSSING RESOURCES (BOATS)
C ERDBCR = EFFECT OF REFUGEES ON DESIRED BORDER CROSSING RESOURCES (DMNL)

      DBCRR = YBCRR * ERDBCR 

C CBCRR  = CHANGE IN BORDER CROSSING RESOURCES (BOATS/MONTH)
C DBCR   = DESIRED BORDER CROSSING RESOURCES (BOATS)
C BCR    = BORDER CROSSING RESOURCES (BOATS)
C ATABCR = AVERAGE TIME TO ADD BORDER CROSSING RESOURCES (MONTHS) 

      CBCRR = (DBCRR - BCRR(1)) / ATABCR

C***********************************************************************
C
C     COMPUTE BCNR = BORDER CONTROL RESOURCES (BOATS)

C DBCNR   = DESIRED BORDER CROSSING RESOURCES (BOATS)
C AIBC   = ALLOCATION OF INVESTMENT TO BORDER CONTROL
C          (MILLION DOLLARS/MONTH)
C ACBCR  = AVERAGE COST OF BORDER CONTROL RESOURCES 
C          (MILLION DOLLARS/BOAT/MONTH)

      DBCNR = AIBC / ACBCR 

C CBCNR  = CHANGE IN BORDER CONTROL RESOURCES (BOATS/MONTH)
C DBCNR  = DESIRED BORDER CONTROL RESOURCES (BOATS)
C BCNR   = BORDER CONTROL RESOURCES (BOATS)
C ATDBCR = AVERAGE TIME TO DEPLOY BORDER CONTROL RESOURCES (MONTHS) 

      CBCNR = (DBCNR - BCNR(1)) / ATDBCR

C***********************************************************************
C
C     COMPUTE B = BUSINESSES (BUSINESSES)

C DB     = DESIRED NUMBER OF BUSINESSES (BUSINESSES)
C PFC    = POPULATION IN FOREIGN COUNTRY (FAMILIES)
C AJB    = AVERAGE JOBS PER BUSINESSES (FAMILIES/BUSINESSES)

      DB = PFC(1) / AJB

C BCM    = BUSINESSES CREATED PER MONTH (BUSINESSES/MONTH)
C DB     = DESIRED BUSINESSES (BUSINESSES)
C B      = BUSINESSES (BUSINESSES)
C AIED   = ALLOCATION OF INVESTMENT TO ECONOMIC DEVELOPMENT
C          (MILLION DOLLARS/MONTH)
C ATCB   = AVERAGE COST TO SETUP A BUSINESS (MONTHS)

      IF (DB .GT. B(1)) THEN
         BCM = AIED / ACSB
      ELSE
         BCM = 0.0
      ENDIF

C EVITDB = EFFECT OF VIOLENCE ON TIME TO DESTROY BUSINESS (DMNL)
C V      = VIOLENCE (BATTLES)
C YVRDB  = NORMAL VIOLENCE REQUIRED TO DESTROY A BUSINESS (BATTLES)

       EVITDB = TABLE(EVITDBT, V(1) / YVRDB)

C ATDB   = AVERAGE TIME TO DESTROY A BUSINESS (MONTHS)
C YTDB   = NORMAL TIME TO DESTROY A BUSINESS (MONTHS)
C EVITDB = EFFECT OF VIOLENCE ON TIME TO DESTROY BUSINESS (DMNL)

       ATDB = YTDB * EVITDB

C BDM    = BUSINESSES DESTROYED PER MONTH (BUSINESSES/MONTH)
C B      = BUSINESSES (BUSINESSES)
C ATDB   = AVERAGE TIME TO DESTROY A BUSINESS (MONTHS)

       BDM = B(1) / ATDB

C***********************************************************************
C
C     COMPUTE DFD = DEATHS FROM DISEASE (FAMILIES)

C DRD    = DEATH RATE FROM DISEASE (FAMILIES/MONTH)
C YDRFD  = NORMAL DEATH RATE FROM DISEASE (FAMILIES/FAMILY/MONTH)
C PWD    = POPULATION WITH DISEASE (FAMILIES)

      DRD = YDRFD * PWD(1)

C***********************************************************************
C
C     COMPUTE DFS = DEATHS FROM STARVATION (FAMILIES)
C                    
C DRS    = DEATH RATE FROM STARVATION (FAMILIES/MONTH)
C YDRFS  = NORMAL DEATH RATE FROM STARVATION (FAMILIES/FAMILY/MONTH)
C PFC    = POPULATION IN FOREIGN COUNTRIES (FAMILIES)
C PEF    = POPULATION WITH ENOUGH FOOD (FAMILIES)

      DRS = YDRFS * (PFC(1) - PEF)

C***********************************************************************
C
C     COMPUTE DFV = DEATHS FROM VIOLENCE (FAMILIES)
C                    
C DRV    = DEATH RATE FROM VIOLENCE (FAMILIES/MONTH)
C YDRFV  = NORMAL DEATH RATE FROM VIOLENCE (FAMILIES/FAMILY/MONTH)
C PFC    = POPULATION IN FOREIGN COUNTRIES (FAMILIES)
C PSH    = POPULATION IN SAFE HAVENS (FAMILIES)

      DRV = YDRFV * (PFC(1) - PSH)

C***********************************************************************
C
C     COMPUTE DFU = DEATHS FROM UNSUCCESSFUL BORDER CROSSINGS 
C                   (FAMILIES)
C
C EBCRAC = EFFECT OF BORDER CROSSING RESOURCES ON ATTEMPTED BORDER
C          CROSSINGS PER MONTH (DMNL)
C BCRR   = BORDER CROSSING RESOURCES (BOATS)
C YBCRR  = NORMAL BORDER CROSSING RESOURCES (BOATS)

      EBCRAC = TABLE(EBCRACT, BCRR(1) / YBCRR)

C EBCRAB = EFFECT OF BORDER CONTROL ON ATTEMPTED BORDER
C          CROSSINGS PER MONTH (DMNL)
C BCNR   = BORDER CONTROL RESOURCES (BOATS)
C YBCNR  = NORMAL BORDER CONTROL RESOURCES (BOATS)

      EBCRAB = TABLE(EBCRABT, BCNR(1) / YBCNR)

C ASBCM  = AVERAGE SUCCESSFUL BORDER CROSSINGS PER MONTH
C          (BORDER CROSSINGS/MONTH)
C SBC    = SUCCESSFUL BORDER CROSSINGS (BORDER CROSSINGS)

      IF (TIME .GT. 1.0) THEN
         ASBCM = SBC(1) / TIME
      ELSE
         ASBCM = 0.0
      ENDIF

C ESBCBC = EFFECT OF SUCCESSFUL BORDER CROSSINGS ON ATTEMPTED 
C          BORDER CROSSINGS PER MONTH (DMNL)
C ASBCM  = AVERAGE SUCCESSFUL BORDER CROSSINGS PER MONTH
C          (BORDER CROSSINGS/MONTH)
C YSBC  = NORMAL SUCCESSFUL BORDER CROSSINGS PER MONTH 
C          (BORDER CROSSINGS/MONTH)

      ESBCBC = TABLE(ESBCBCT, ASBCM / YSBC)

C AUBCM  = AVERAGE UNSUCCESSFUL BORDER CROSSINGS PER MONTH
C          (BORDER CROSSINGS/MONTH)
C UBC    = UNSUCCESSFUL BORDER CROSSINGS (BORDER CROSSINGS)

      IF (TIME .GT. 1.0) THEN
         AUBCM = UBC(1) / TIME
      ELSE
         AUBCM = 0.0
      ENDIF
  
C EUBCBC = EFFECT OF UNSUCCESSFUL BORDER CROSSINGS ON ATTEMPTED 
C          BORDER CROSSING PER MONTH (DMNL)
C AUBCM  = UNSUCCESSFUL BORDER CROSSINGS (BORDER CROSSINGS)
C YUBC   = NORMAL UNSUCCESSFUL BORDER CROSSINGS PER MONTH 
C          (BORDER CROSSINGS/MONTH)

      EUBCBC = TABLE(EUBCBCT, AUBCM / YUBC)

C ERABCM = EFFECT OF REFUGEES ON ATTEMPTED BORDER CROSSINGS PER 
C          MONTH (DMNL)
C R      = REFUGEES (FAMILIES)
C YR     = NORMAL REFUGEES (FAMILIES)

      ERABCM = TABLE(ERABCMT, R(1) / YR)

C ABCM   = ATTEMPTED BORDER CROSSINGS PER MONTH 
C          (BORDER CROSSINGS/MONTH)
C YABC  = NORMAL ATTEMPTED BORDER CROSSINGS PER MONTH 
C          (BORDER CROSSINGS)
C EBCRAC = EFFECT OF BORDER CROSSING RESOURCES ON ATTEMPTED BORDER
C          CROSSINGS PER MONTH (DMNL)
C ESBCBC = EFFECT OF SUCCESSFUL BORDER CROSSINGS ON ATTEMPTED 
C          BORDER CROSSINGS PER MONTH (DMNL)
C EUBCBC = EFFECT OF UNSUCCESSFUL BORDER CROSSINGS ON ATTEMPTED 
C          BORDER CROSSING PER MONTH (DMNL)
C EIBCAC = EFFECT OF INVESTMENT IN BORDER CONTROL ON ATTEMPTED 
C          BORDER CROSSINGS (DMNL)
C ERABCM = EFFECT OF REFUGEES ON ATTEMPTED BORDER CROSSINGS PER 
C          MONTH (DMNL)

      IF (TIME .EQ. 0.0) THEN
         ABCM = 0.0
      ELSE
         ABCM = YABC * EBCRAC * EBCRAB * ESBCBC * EUBCBC *  ERABCM
      ENDIF

C EBCRFC = EFFECT OF BORDER CROSSING RESOURCES ON FAMILIES PER 
C          BORDER CROSSING
C BCRR   = BORDER CROSSING RESOURCES (BOATS)
C YBCRR  = NORMAL BORDER CROSSING RESOURCES (BOATS)

      EBCRFC = TABLE(EBCRFCT, BCRR(1) / YBCRR)

C FBC    = FAMILIES PER BORDER CROSSING (FAMILIES)
C YFBC   = NORMAL FAMILIES PER BORDER CROSSING (FAMILIES)
C EBCRFC = EFFECT OF BORDER CROSSING RESOURCES ON FAMILIES PER 
C          BORDER CROSSING

      FBC = YFBC * EBCRFC

C EBCRUC = EFFECT OF BORDER CROSSING RESOURCES ON FRACTION OF 
C          UNSUCCESSFUL BORDER CROSSINGS
C BCRR   = BORDER CROSSING RESOURCES (BOATS)
C YBCRR  = NORMAL BORDER CROSSING RESOURCES (BOATS)

      EBCRUC = TABLE(EBCRUCT, BCRR(1) / YBCRR)

C FBCU   = FRACTION OF BORDER CROSSINGS UNSUCCESSFUL (DMNL)
C YFUBC  = NORMAL FRACTION OF UNSUCCESSFUL BORDER CROSSINGS (DMNL)
C EBCRUC = EFFECT OF BORDER CROSSING RESOURCES ON FRACTION OF 
C          UNSUCCESSFUL BORDER CROSSINGS

      FBCU = YFUBC * EBCRUC

C DUBCM  = DEATHS FROM UNSUCCESSFUL BORDER CROSSINGS PER MONTH
C         (FAMILIES/MONTH)
C ABCM   = ATTEMPTED BORDER CROSSINGS PER MONTH 
C          (BORDER CROSSINGS/MONTH)
C FBCU   = FRACTION OF BORDER CROSSINGS THAT ARE UNSUCCESSFUL (DMNL)
C FBC    = FAMILIES PER BORDER CROSSING (FAMILIES/BORDER CROSSING)
C         (FAMILIES/BORDER CROSSING)
C FDUBC  = FRACTION OF DEATHS PER UNSUCCESSFUL BORDER BORDER CROSSING
C         (DMNL)

      DUBCM = ABCM * FBCU * FBC * FDUBC

C***********************************************************************
C
C     COMPUTE DE = DIPLOMATIC EFFORT (DIPLOMATS)

C DDE    = DESIRED DIPLOMATIC EFFORT (DIPLOMATS)
C AID    = ALLOCATION OF INVESTMENT TO DIPLOMACY
C          (MILLION DOLLARS/MONTH)
C ACDE   = AVERAGE COST OF DIPLOMATIC EFFORT 
C          (MILLION DOLLARS/DIPLOMAT/MONTH)

      DDE = AID / ACDE 

C CDE    = CHANGE IN DIPLOMATIC EFFORT (DIPLOMATS/MONTH)
C DDE    = DESIRED DIPLOMATIC EFFORT (DIPLOMATS)
C BCNR   = BORDER CONTROL RESOURCES (BOATS)
C ATED   = AVERAGE TIME TO EMPLOY DIPLOMATS (MONTHS) 

      CDE = (DDE - DE(1)) / ATED

C***********************************************************************
C
C     COMPUTE F = FOOD (FOOD UNITS)

C EVODFA = EFFECT OF VIOLENCE ON DISTRIBUTION OF FOOD AID (DMNL)
C V      = VIOLENCE (BATTLES)
C YVRDFA = NORMAL VIOLENCE REQUIRED TO DISRUPT DELIVERY OF FOOD AID 
C          (BATTLES)

       EVODFA = TABLE(EVODFAT, V(1) / YVRDFA)

C FAM    = FOOD AID PER MONTH (FOOD UNITS/MONTH)
C AIFA   = ALLOCATION OF INVESTMENT TO FOOD AID 
C          (MILLION DOLLARS/MONTH)
C ACFU   = AVERAGE COST OF A FOOD UNIT (MILLION DOLLARS/FOOD UNIT)
C EVODFA = EFFECT OF VIOLENCE ON DISTRIBUTION OF FOOD AID (DMNL)

       FAM = AIFA / ACFU * EVODFA

C FCM    = FOOD CONSUMPTION PER MONTH (FOOD UNITS/MONTH)
C F      = FOOD (MILLION FOOD UNITS)
C YF     = NORMAL FOOD (MILLION FOOD UNITS)
C ACPF   = AVERAGE CONSUMPTION PER FAMILY PER MONTH 
C          (FOOD UNITS/FAMILY/MONTH)
C PFC    = POPULATION IN FOREIGN COUNTRY (FAMILIES)

       FCM = (F(1) / YF) * ACPF * PFC(1)

C EVIOFM = EFFECT OF VIOLENCE ON FAMINE (DMNL)
C V      = VIOLENCE (BATTLES)
C YVRDH  = NORMAL VIOLENCE REQUIRED TO DESTROY A HARVEST (BATTLES)

       EVIOFM = TABLE(EVIOFMT, V(1) / YVRDH)

C FGR    = FOOD GROWTH RATE (FOOD UNITS/FOOD UNIT/MONTH)
C YFGR   = NORMAL FOOD GROWTH RATE (FOOD UNITS/FOOD UNIT/MONTH)
C EVIOFM = EFFECT OF VIOLENCE ON FAMINE (DMNL)

       FGR = YFGR * (1.0 - EVIOFM)

C FGM    = FOOD GROWTH PER MONTH (FOOD UNITS/MONTH)
C FGR    = FOOD GROWTH RATE (FOOD UNITS/FOOD UNIT/MONTH)
C F      = FOOD (FOOD UNITS)

       FGM = DMAX1(0.0, FGR * F(1))

C FEM    = FOOD EXPORTED PER MONTH (FOOD UNITS/MONTH)
C F      = FOOD (FOOD UNITS)
C PFC    = POPULATION IN FOREIGN COUNTRY (FAMILIES)
C ACPF   = AVERAGE FOOD COMSUMPTION PER FAMILY PER MONTH 
C          (FOOD UNITS/FAMILY)

       FEM = DMAX1(0.0, (F(1) - (PFC(1) * ACPF)))

C***********************************************************************
C
C     COMPUTE ZIO = IMMIGRATION OFFICERS (OFFICERS)

C DIO    = DESIRED IMMIGRATION OFFICERS (OFFICERS)
C AII    = ALLOCATION OF INVESTMENT TO IMMIGRATION
C          (MILLION DOLLARS/MONTH)
C ACIO   = AVERAGE COST OF IMMIGRATION OFFICERS  
C          (MILLION DOLLARS/OFFICER/MONTH)

      DIO = AII / ACIO 

C CIO    = CHANGE IN IMMIGRATION OFFICERS (OFFICERS/MONTH)
C DIO    = DESIRED IMMIGRATION OFFICERS (OFFICERS)
C BCNR   = BORDER CONTROL RESOURCES (BOATS)
C ATTIO  = AVERAGE TIME TO TRAIN IMMIGRATION OFFICERS (MONTHS) 

      CIO = (DIO - ZIO(1)) / ATTIO

C***********************************************************************
C
C     COMPUTE ZMP = MEDICAL PRACTITIONERS (DOCTORS)

C DMP    = DESIRED MEDICAL PRACTITIONERS (DOCTORS)
C AIHS   = ALLOCATION OF INVESTMENT TO HEALTH SERVICES
C          (MILLION DOLLARS/MONTH)
C ACMP   = AVERAGE COST OF MEDICAL PRACTITIONERS 
C          (MILLION DOLLARS/DOCTOR/MONTH)

      DMP = AIHS / ACMP 

C CMP    = CHANGE IN MEDICAL PRACTITIONERS (DOCTORS/MONTH)
C DMP    = DESIRED MEDICAL PRACTITIONERS (DOCTORS)
C ZMP    = MEDICAL PRACTITIONERS (DOCTORS)
C ATHMP  = AVERAGE TIME TO HIRE MEDICAL PRACTITIONERS (MONTHS) 

      CMP = (DMP - ZMP(1)) / ATHMP

C***********************************************************************
C
C     COMPUTE P = PEACEKEEPERS (SOLDIERS)

C DP     = DESIRED PEACEKEEPERS (SOLDIERS)
C AIP    = ALLOCATION OF INVESTMENT TO PEACEKEEPING
C          (MILLION DOLLARS/MONTH)
C ACP    = AVERAGE COST OF PEACEKEEPERS 
C          (MILLION DOLLARS/SOLDIER/MONTH)

      DP = AIP / ACP 

C CP     = CHANGE IN SOLDIERS (SOLDIERS/MONTH)
C DP     = DESIRED PEACEKEEPERS (SOLDIERS)
C P      = PEACEKEEPERS (SOLDIERS)
C ATDP   = AVERAGE TIME TO DEPLOY PEACEKEEPERS (MONTHS) 

      CP = (DP - P(1)) / ATDP

C***********************************************************************
C
C     COMPUTE PFC = POPULATION IN FOREIGN COUNTRY
C                    (MILLION DOLLARS/MONTH)
C
C
C ZNBR   = NET BIRTH RATE (FAMILIES/MONTH)
C YBR    = NORMAL BIRTH RATE (FAMILIES/FAMILY/MONTH)
C PFC    = POPULATION IN FOREIGN COUNTRIES (FAMILIES)
C ALE    = AVERAGE LIFE EXPECTENCY (MONTHS)
 
      ZNBR = (YBR * PFC(1)) - (PFC(1)/ALE)

C ERTDLC = EFFECT OF PEOPLE AT RISK ON AVERAGE TIME TO DECIDE TO LEAVE 
C          FOREIGN COUNTRY (DMNL)
C PFC    = POPULATION IN FOREIGN COUNTRY (FAMILIES)
C PU     = POPULATION UNAFFECTED (FAMILIES)

      ERTDLC = TABLE(ERTDLCT, (PFC(1) - PU) / PFC(1))

C ATDLFC = AVERAGE TIME TO DECIDE TO LEAVE FOREIGN COUNTRY (MONTHS)
C YTDLFC = NORMAL TIME TO DECIDE TO LEAVE FOREIGN COUNTRY (MONTHS)
C ERTDLC = EFFECT OF PEOPLE IN DANGER ON TIME TO DECIDE TO LEAVE 
C          FOREIGN COUNTRY (DMNL)

      ATDLFC = YTDLFC * ERTDLC

C ZNAR   = NET ADDITIONS TO REFUGEES (FAMILIES/MONTH)
C PFC    = POPULATION IN FOREIGN COUNTRIES (FAMILIES)
C PU     = POPULATION UNAFFECTED (FAMILIES)
C ATDLFC = AVERAGE TIME TO DECIDE TO LEAVE FOREIGN COUNTRY (MONTHS)

      ZNAR = (PFC(1) - PU) / ATDLFC

C***********************************************************************
C
C     COMPUTE PWD = POPULATION WITH DISEASE (FAMILIES)

C CF     = CROWDING FRACTION (DMNL)
C PSH    = POPULATION IN SAFE HAVENS (HAVENS)
C YPSH   = NORMAL POPULATION IN SAFE HAVENS (FAMILIES/HAVEN)

      CF = PSH / YPSH

C EOCODR = EFFECT OF CROWDING ON DISEASE RATE (DMNL)
C CF     = CROWDING FRACTION (DMNL)

      EOCODR = TABLE(EOCODRT, CF)

C ZIM    = INFECTIONS PER MONTH (FAMILIES/MONTH)
C PWD    = POPULATION WITH DISEASE (FAMILIES)
C PSH    = POPULATION IN SAFE HAVENS (FAMILIES)
C YIR    = NORMAL INFECTION RATE (DMNL)
C EOCODR = EFFECT OF CROWDING ON DISEASE RATE (DMNL)

      IF (PWD(1).GT.0.0) THEN
         ZIM = (PSH - PWD(1)) * YIR * EOCODR
      ELSE
         ZIM = 0.0
      ENDIF

C CPM    = CURED PER MONTH (FAMILIES/MONTH)
C PWD    = POPULATION WITH DISEASE (FAMILIES)
C ZMP    = MEDICAL PRACTITIONERS (DOCTORS)
C APMP   = AVERAGE PEOPLE A MEDICAL PRACTITIONER CAN HANDLE
C          (FAMILIES/DOCTOR)
C ATCD   = AVERAGE TIME TO CURE DISEASE (MONTHS)

      IF (PWD(1).GT.0.0) THEN
         CPM = ZMP(1) * APMP / ATCD
      ELSE
         CPM = 0.0
      ENDIF
 
C***********************************************************************
C
C     COMPUTE R = REFUGEES (FAMILIES)

C RABC   = REFUGEES ATTEMPTING BORDER CROSSINGS 
C          (FAMILIES/MONTH)
C R      = REFUGEES (FAMILIES)
C ABCM   = ATTEMPTED BORDER CROSSINGS PER MONTH 
C          (BORDER CROSSINGS/MONTH)
C FBC    = FAMILIES PER BORDER CROSSING (FAMILIES/BORDER CROSSING)

      IF (R(1).LE.(ABCM*FBC)) THEN
         RABC = R(1)
      ELSE
         RABC = ABCM * FBC
      ENDIF

C RPM    = REFUGEES PROCESSED PER MONTH (FAMILIES/MONTH)
C ZIO    = IMMIGRATION OFFICERS (OFFICERS)
C FPIO   = FAMILIES PROCESSED AT SAME TIME BY IMMIGRATION OFFICERS
C          (FAMILIES/OFFICER)
C ATPIP  = AVERAGE TIME TO PROCESS IMMIGRATION PAPERS (MONTHS)

      RPM = ZIO(1) * FPIO / ATPIP
    
C***********************************************************************
C
C     COMPUTE SH = SAFE HAVENS (HAVENS)

C DSH    = DESIRED SAFE HAVENS (HAVENS)
C PFC    = POPULATION OF FOREIGN COUNTRY (FAMILIES)
C APSH   = AVERAGE POPULATION PER SAFE HAVEN (FAMILIES/HAVEN)

      DSH = PFC(1) / APSH

C EPTCSH = EFFECT OF PEACEKEEPERS ON TIME TO CREATE A SAFE HAVEN (DMNL)
C P      = PEACEKEEPERS (SOLDIERS)
C YPRSH  = NORMAL PEACEKEEPERS REQUIRED TO PROTECT A SAFE HAVEN
C          (SOLDIERS)

      EPTCSH = TABLE(EPTCSHT, P(1) / YPRSH)

C ATCSH  = AVERAGE TIME TO CREATE A SAFE HAVEN (MONTHS)
C YTCSH  = NORMAL TIME TO CREATE A SAFE HAVEN (MONTHS)
C EPTCSH = EFFECT OF PEACEKEEPERS ON TIME TO CREATE A SAFE HAVEN (DMNL)

      ATCSH = YTCSH * EPTCSH

C SHC    = SAFE HAVENS CREATED (HAVENS/MONTH)
C DSH    = DESIRED SAFE HAVENS (HAVENS)
C SH     = SAFE HAVENS (HAVENS)
C ATCSH  = AVERAGE TIME TO CREATE A SAFE HAVEN (MONTHS)

      SHC = (DSH - SH(1)) / ATCSH

C EVTDSH = EFFECT OF VIOLENCE ON TIME TO DESTROY A SAFE HAVEN (DMNL)
C V      = VIOLENCE LEVEL (BATTLES)
C YVRDSH = NORMAL VIOLENCE REQUIRED TO DESTROY A SAFE HAVEN (BATTLES)

      EVTDSH = TABLE(EVTDSHT, V(1) / YVRDSH) 

C ATDSH  = AVERAGE TIME TO DESTROY A SAFE HAVEN (MONTHS)
C YTDSH  = NORMAL TIME TO DESTROY A SAFE HAVEN (MONTHS)
C EVTDSH = EFFECT OF VIOLENCE ON TIME TO DESTROY A SAFE HAVEN (DMNL)

      ATDSH = YTDSH * EVTDSH

C SHD    = SAFE HAVENS DESTROYED (HAVENS/MONTH)
C SH     = SAFE HAVENS (HAVENS)
C ATDSH  = AVERAGE TIME TO DESTROY A SAFE HAVEN (MONTHS)

      SHD = SH(1) / ATDSH

C***********************************************************************
C
C     COMPUTE SBC = SUCCESSFUL BORDER CROSSINGS (BORDER CROSSINGS)

C SBCM   = SUCCESSFUL BORDER CROSSINGS PER MONTH 
C          (BORDER CROSSINGS/MONTH)
C FBCU   = FRACTION OF BORDER CROSSINGS THAT ARE UNSUCCESSFUL (DMNL)
C ABCM   = ATTEMPTED BORDER CROSSINGS PER MONTH 
C          (BORDER CROSSINGS/MONTH)

       SBCM = (1.0 - FBCU) * ABCM

C***********************************************************************
C
C     COMPUTE UBC = UNSUCCESSFUL BORDER CROSSINGS (BORDER CROSSINGS)

C UBCM   = UNSUCCESSFUL BORDER CROSSINGS PER MONTH 
C          (BORDER CROSSINGS/MONTH)
C FBCU   = FRACTION OF BORDER CROSSINGS THAT ARE UNSUCCESSFUL (DMNL)
C ABCM   = ATTEMPTED BORDER CROSSINGS PER MONTH 
C          (BORDER CROSSINGS/MONTH)

       UBCM = FBCU * ABCM

C***********************************************************************
C
C     COMPUTE V = VIOLENCE (BATTLES)

C DV     = DESIRED VIOLENCE LEVEL (BATTLES)
C V      = VIOLENCE LEVEL (BATTLES)
C VER    = VIOLENCE ESCALATION RATE (DMNL)
C P      = PEACEKEEPERS (SOLDIERS)
C APRB   = AVERAGE PEACEKEEPERS TO REDUCE A BATTLE (SOLDIERS)
C DE     = DIPLOMATIC EFFORT (DIPLOMATS)
C ADCCF  = AVERAGE DIPLOMATS TO CREATE A CEASE FIRE (DIPLOMATS)

      IF (V(1).LE.0.0) THEN
         DV = 0.0
      ELSE
         DV = (V(1) * VER) - ((P(1) / APRB) + (DE(1) / ADCCF))
      ENDIF

C ZDV    = LIMITED DESIRED VIOLENCE LEVEL (BATTLES)
C DV     = DESIRED VIOLENCE LEVEL (BATTLES)

      IF (DV.LE.0.0) THEN
         ZDV = 0.0
      ELSE
         ZDV = DV
      ENDIF

C CVL    = CHANGE IN VIOLENCE LEVEL (BATTLES/MONTH)
C ZDV    = LIMITED DESIRED VIOLENCE LEVEL (BATTLES)
C V      = VIOLENCE LEVEL (BATTLES)
C ATCVL  = AVERAGE TIME TO CHANGE VIOLENCE LEVEL (MONTHS) 

      CVL = (ZDV - V(1)) / ATCVL

C***********************************************************************
C
C PRINT ALL VARIABLES FOR COMPARISON WITH VENSIM MODEL


C      WRITE(8,*)TIME,ABCM,ADFSM,ADFVM,ADFDM,ADFUM,ASBCM,ATCSH,ATDLFC
C     1 ATDB,ATDSH,AUBCM,ADM,BCNR(1),BCRR(1),B(1),BCM,BDM,CBCNR,CBCRR,
C     1 CDE,CIO,CMP,CP,CVL,CF,CAD,CPM,DRD,DRS,DRV,DFD(1),DFS(1),DFU(1),
C     1 DFV(1),DUBCM,DDE,DBCNR,DBCRR,DFID,DFIFA,DFIHS,DFII,DFIP,DB,DIO,
C     1 DMP,DP,DSH,DV,DE(1),FEM,FBC,EVIOFM,F(1),FAM,FCM,FGM,FGR,FBCU,
C     1 FIBC,FRID,FRIFA,FRIHS,FRII,FRIP,ZIO(1),ZIM,AIBC,AID,AIED,AIFA,
C     1 AIHS,AII,AIP,ZDV,ZMP(1),ZNAR,ZNBR,P(1),PFC(1),PSH,PU,PWD(1),PEF,
C     1 PWJ,PWOD,R(1),RABC,RPM,RI(1),SH(1),SHC,SHD,SBC(1),SBCM,TI,
C     1 UBC(1),UBCM,V(1)


C***********************************************************************
C
C COMPUTE STATE VARIABLES FOR NEXT STEP

C***********************************************************************
C BCRR   = BORDER CROSSING RESOURCES (BOATS)
C XINC   = STEP SIZE OF SIMULATION
C CBCRR  = CHANGE IN BORDER CROSSING RESOURCES (BOATS/MONTH)

      BCRR(2) = BCRR(1) + XINC * CBCRR

C***********************************************************************
C BCNR   = BORDER CONTROL RESOURCES (BOATS)
C XINC   = STEP SIZE OF SIMULATION
C CBCNR  = CHANGE IN BORDER CONTROL RESOURCES (BOATS/MONTH)

      BCNR(2) = BCNR(1) + XINC * CBCNR

C***********************************************************************
C B      = BUSINESSES (BUSINESSES)
C XINC   = STEP SIZE OF SIMULATION
C BCM    = BUSINESSES CREATED (BUSINESSES/MONTH)
C BDM    = BUSINESSES DESTROYED PER MONTH (BUSINESSES/MONTH)

      B(2) = B(1) + XINC * (BCM - BDM)

C***********************************************************************
C DFD    = DEATHS FROM DISEASE (FAMILIES)
C XINC   = STEP SIZE OF SIMULATION
C DRD    = DEATH RATE FROM DISEASE (FAMILIES/MONTH)

      DFD(2) = DFD(1) + XINC * DRD

C***********************************************************************
C DFS    = DEATHS FROM STARVATION (FAMILIES)
C XINC   = STEP SIZE OF SIMULATION
C DRS    = DEATH RATE FROM STARVATION (FAMILIES/MONTH)

      DFS(2) = DFS(1) + XINC * DRS

C***********************************************************************
C DFV    = DEATHS FROM VIOLENCE (FAMILIES)
C XINC   = STEP SIZE OF SIMULATION
C DRV    = DEATH RATE FROM VIOLENCE (FAMILIES/MONTH)

      DFV(2) = DFV(1) + XINC * DRV

C***********************************************************************
C DFU    = DEATHS FROM UNSUCCESSFUL BORDER CROSSING (FAMILIES)
C XINC   = STEP SIZE OF SIMULATION
C DUBCM  = DEATHS FROM UNSUCCESSFUL BORDER CROSSINGS PER MONTH
C         (FAMILIES/MONTH)

      DFU(2) = DFU(1) + XINC * DUBCM

C***********************************************************************
C DE     = DIPLOMATIC EFFORT (DIPLOMATS)
C XINC   = STEP SIZE OF SIMULATION
C CDE    = CHANGE IN DIPLOMATIC EFFORT (DIPLOMATS/MONTH)

      DE(2) = DE(1) + XINC * CDE

C***********************************************************************
C F      = FOOD (FOOD uNITS)
C XINC   = STEP SIZE OF SIMULATION
C FGM    = FOOD GROWTH PER MONTH (FOOD UNITS/MONTH)
C FAM    = FOOD AID PER MONTH (FOOD UNITS/MONTH)
C FEM    = EXPORT OF FOOD PER MONTH (FOOD UNITS/MONTH)
C FCM    = FOOD CONSUMPTION PER MONTH (FOOD UNITS/MONTH)

      F(2) = F(1) + XINC * (FGM + FAM - FCM - FEM)

C***********************************************************************
C ZIO    = IMMIGRATION OFFICERS (OFFICERS)
C XINC   = STEP SIZE OF SIMULATION
C CIO    = CHANGE IN IMMIGRATION OFFICERS (OFFICERS/MONTH)

      ZIO(2) = ZIO(1) + XINC * CIO

C***********************************************************************
C ZMP    = MEDICAL PRACTITIONERS (DOCTORS)
C XINC   = STEP SIZE OF SIMULATION
C CMP    = CHANGE IN MEDICAL PRACTITIONERS (DOCTORS/MONTH)

      ZMP(2) = ZMP(1) + XINC * CMP

C***********************************************************************
C P      = PEACEKEEPERS (SOLDIERS)
C XINC   = STEP SIZE OF SIMULATION
C CP     = CHANGE IN PEACEKEEPERS (SOLDIERS/MONTH)

      P(2) = P(1) + XINC * CP

C***********************************************************************
C PFC    = POPULATION IN FOREIGN COUNTRIES (FAMILIES)
C XINC   = STEP SIZE OF SIMULATION
C ZNBR   = NET BIRTH RATE (FAMILIES/MONTH)
C DRD    = DEATH RATE FROM DISEASE (FAMILIES/MONTH)
C DRS    = DEATH RATE FROM STARVATION (FAMILIES/MONTH)
C DRV    = DEATH RATE FROM VIOLENCE (FAMILIES/MONTH)
C ZNAR   = NET ADDITIONS TO REFUGEES

      PFC(2) = PFC(1) + XINC * (ZNBR - ZNAR - DRD - DRS -DRV) 

C***********************************************************************
C PWD    = POPULATION WITH DISEASE (FAMILIES)
C XINC   = STEP SIZE OF SIMULATION
C ZIM    = INFECTIONS PER MONTH (FAMILIES/MONTH)
C CPM    = CURED PER MONTH (FAMILIES/MONTH)

      PWD(2) = PWD(1) + XINC * (ZIM - CPM) 

C***********************************************************************
C R      = REFUGEES (FAMILIES)
C XINC   = STEP SIZE OF SIMULATION
C ZNAR   = NET ADDITIONS TO REFUGEES (FAMILIES/MONTH)
C RPM    = REFUGEES PROCESSED PER MONTH (FAMILIES/MONTH)
C RABC   = REFUGEES ATTEMPTING BORDER CROSSINGS (FAMILIES/MONTH)

      R(2) = R(1) + XINC * (ZNAR - RPM - RABC)

C***********************************************************************
C RI     = REFUGEES WHO HAVE IMMIGRATED (FAMILIES)
C XINC   = STEP SIZE OF SIMULATION
C RPM    = REFUGEES PROCESSED PER MONTH (FAMILIES/MONTH)

      RI(2) = RI(1) + XINC * RPM

C***********************************************************************
C SH     = SAFE HAVENS (HAVENS)
C XINC   = STEP SIZE OF SIMULATION
C SHC    = SAFE HAVENS CREATED PER MONTH (HAVENS/MONTH)
C SHD    = SAFE HAVENS DESTROYED PER MONTH (HAVENS/MONTH)

      SH(2) = SH(1) + XINC * (SHC - SHD)

C***********************************************************************
C SBC    = SUCCESSFUL BORDER CROSSINGS (BORDER CROSSINGS)
C XINC   = STEP SIZE OF SIMULATION
C SBCM   = SUCCESSFUL BORDER CROSSINGS PER MONTH 
C          (BORDER CROSSINGS/MONTH)

      SBC(2) = SBC(1) + XINC * SBCM

C***********************************************************************
C UBC    = UNSUCCESSFUL BORDER CROSSINGS (BORDER CROSSINGS)
C XINC   = STEP SIZE OF SIMULATION
C UBCM   = UNSUCCESSFUL BORDER CROSSINGS PER MONTH 
C          (BORDER CROSSINGS/MONTH)

       UBC(2) = UBC(1) + XINC * UBCM 

C***********************************************************************
C V      = VIOLENCE (BATTLES)
C XINC   = STEP SIZE OF SIMULATION
C CVL    = CHANGE IN VIOLENCE LEVEL (BATTLES/MONTH)

       V(2) = V(1) + XINC * CVL

C***********************************************************************
C     UPDATE STATE VARIABLES
C
C01   BCNR = INITIAL BORDER CONTROL RESOURCES (BOATS)
C02   BCRR = INITIAL BORDER CROSSING RESOURCES (BOATS)
C03   B = INITIAL BUSINESSES (BUSINESSES)
C04   DFD = INITIAL DEATHS FROM DISEASE (FAMILIES)
C05   DFS = INITIAL DEATHS FROM STARVATION (FAMILIES)
C06   DFU = INITIAL DEATHS FROM UNSUCCESSFUL BORDER CROSSINGS (FAMILIES)
C07   DFV = INITIAL DEATHS FROM VIOLENCE (FAMILIES)
C08   DE = INITIAL DIPLOMATIC EFFORT (DIPLOMATS)
C09   F = INITIAL FOOD (FOOD UNITS)
C10   IO = INITIAL IMMIGRATION OFFICERS (OFFICERS)
C11   MP = INITIAL MEDICAL PRACTITIONERS (DOCTORS)
C12   P = INITIAL PEACEKEEPERS (SOLDIERS)
C13   PFC = INITIAL POPULATION IN FOREIGN COUNTRY (FAMILIES)
C14   PWD = INITIAL POPULATION WITH DISEASE (FAMILIES)
C15   R = INITIAL REFUGEES (FAMILIES)
C16   RI = INITIAL REFUGEES WHO HAVE IMMIGRATED (FAMILIES)
C17   SH = INITIAL SAFE HAVENS (HAVENS)
C18   SBC = INITIAL SUCCESSFUL BORDER CROSSINGS (BORDER CROSSINGS)
C19   UBC = INITIAL UNSUCCESSFUL BORDER CROSSINGS (BORDER CROSSINGS)
C20   V = INITIAL VIOLENCE (BATTLES)

      BCNR(1) = BCNR(2)
      BCRR(1) = BCRR(2)
      B(1)    = B(2)
      DFD(1)  = DFD(2)
      DFS(1)  = DFS(2)
      DFU(1)  = DFU(2)
      DFV(1)  = DFV(2)
      DE(1)   = DE(2)
      F(1)    = F(2)
      ZIO(1)  = ZIO(2)
      ZMP(1)  = ZMP(2)
      P(1)    = P(2)
      PFC(1)  = PFC(2)
      PWD(1)  = PWD(2)
      R(1)    = R(2)
      RI(1)   = RI(2)
      SH(1)   = SH(2)
      SBC(1)  = SBC(2)
      UBC(1)  = UBC(2)
      V(1)    = V(2)

      TIME = TIME + XINC

      GO TO 10

C***********************************************************************
C
C     SIMULATION RUN ENDS
C

20    CONTINUE

C CAD    = CUMULATIVE AVOIDABLE DEATHS (FAMILIES)
C DFS    = DEATHS FROM STARVATION (FAMILIES)
C DFV    = DEATHS FROM VIOLENCE (FAMILIES)
C DFD    = DEATHS FROM DISEASE (FAMILIES)
C DFU    = DEATHS FROM UNSUCCESSFUL BORDER CROSSING (FAMILIES)

      CAD = DFS(1) + DFV(1) + DFD(1) + DFU(1)

      RETURN
      END  

C***********************************************************************
C
      FUNCTION TABLE(TBL,VAR)
C
C    THIS FUNCTION PERFORMS THE OPERATIONS OF THE TABLE OPERATION.  
c    A LINEAR INTERPOLATION IS PERFORMAED IN
C    TABLE OF VALUES TBL TO OBTAIN A VALUE WHICH CORRESPONDS TO THE
C    ARGUMENT VALUE VAR.  VLO, VHI AND STEP SPECIFY THE HIGH VALUE, LOW
C    VALUE, AND STEP SIZE, REPSECTIVELY, FOR THE INDEPENDENT VARIABLE
C    SO THAT A CORRESPONDENCE IS SET UP BETWEEN THE INDEPENDENT VARIABLE
C    VALUES AND TEH TABLE OF VALUES SPECIFIED INT EH TBL BY THE CALLING
C    PROGRAM.  IF THE SPECIFIED VALUE OF VAR IS OUTSIDE THE RANGE
C    VLO-VHI, THEN VAR IS ASSIGNED THE FIRST VALUE IN TBL IF VAR IS LESS
C    THAN VLO AND VAR IS ASSIGNED THE LAST VALUE IN TBL IF VAR IS GREATER
C    THAN VHI.

      IMPLICIT DOUBLE PRECISION (A-H, O-Z)

      DIMENSION TBL(3,2)

      IF (VAR .LE. TBL(1,1)) GO TO 100
      IF (VAR .GE. TBL(3,1)) GO TO 200
      IF (VAR .GT. TBL(1,1) .AND. VAR .LE. TBL(2,1)) THEN
         TABLE = TBL(1,2) + ((TBL(2,2) - TBL(1,2)) * (VAR - TBL(1,1))
     1           / (TBL(2,1) - TBL(1,1)))
      ELSE
         TABLE = TBL(2,2) + ((TBL(3,2) - TBL(2,2)) * (VAR - TBL(2,1))
     1           / (TBL(3,1) - TBL(2,1)))
      ENDIF
      RETURN
  100 TABLE = TBL(1,2)
      RETURN
  200 TABLE = TBL(3,2)
      RETURN
      END     

      SUBROUTINE OVERCHECK(XNUMBER)

      IMPLICIT DOUBLE PRECISION (A-H, O-Z)

      IF (ABS(XNUMBER) .GT. 1.0E20) THEN
         XNUMBER = 1.0E10
      ENDIF
      RETURN
      END


      SUBROUTINE UNDERCHECK(XNUMBER)

      IMPLICIT DOUBLE PRECISION (A-H, O-Z)

      IF (ABS(XNUMBER) .LT. 1.0E-20) THEN
         XNUMBER = 0.0
      ENDIF
      RETURN
      END
            
